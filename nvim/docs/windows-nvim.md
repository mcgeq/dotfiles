# windows.nvim - 自动窗口调整

## 📖 简介

windows.nvim 自动调整当前窗口的大小，让你始终专注于正在编辑的内容。带平滑动画效果，提升多窗口工作体验。

## 🎯 核心功能

- ✅ 自动扩展当前窗口
- ✅ 平滑动画过渡
- ✅ 手动最大化/还原
- ✅ 智能大小计算
- ✅ 保持布局平衡

## 🎨 视觉效果

### 切换前（均等布局）

```
┌─────┬─────┬─────┐
│  1  │  2  │  3  │
│     │     │     │
│     │     │     │
└─────┴─────┴─────┘
```

### 切换到窗口 2 后（自动扩展）

```
┌──┬────────┬──┐
│ 1│   2    │ 3│
│  │        │  │
│  │        │  │
└──┴────────┴──┘
   ↑        ↑
  缩小   扩展+动画
```

## 💡 工作原理

### 智能扩展

```
原理：当前窗口扩展，其他窗口收缩

窗口 A（inactive）:
┌─────┐
│     │ 30% 宽度
└─────┘

切换到窗口 A:
┌───────────┐
│           │ 70% 宽度（自动扩展）
└───────────┘

切换离开:
┌─────┐
│     │ 30% 宽度（自动恢复）
└─────┘
```

### 动画效果

```
切换窗口时的动画过程：

t=0ms:   ┌─────┬─────┬─────┐
         │  A  │  B  │  C  │

t=100ms: ┌───┬──────┬────┐
         │ A │  B   │ C  │

t=200ms: ┌──┬────────┬──┐
         │A │   B    │ C│  <- 完成
```

## ⌨️ 快捷键

### 窗口导航（自动触发）

```vim
Ctrl-h     " 跳转到左窗口 -> 自动扩展
Ctrl-l     " 跳转到右窗口 -> 自动扩展
Ctrl-j     " 跳转到下窗口 -> 自动扩展
Ctrl-k     " 跳转到上窗口 -> 自动扩展
```

### 手动控制

```vim
:WindowsMaximize      " 最大化当前窗口
:WindowsMaximizeVert  " 垂直最大化
:WindowsMaximizeHorz  " 水平最大化
:WindowsRestore       " 还原所有窗口
:WindowsToggle        " 切换自动调整
```

## 🔥 使用场景

### 场景 1：代码对比

```vim
" 对比两个文件
:vsplit other_file.rs

# 初始布局（50/50）:
┌──────────┬──────────┐
│ file1.rs │ file2.rs │
│          │          │
└──────────┴──────────┘

# 切换到 file1.rs（自动扩展）:
┌─────────────┬─────┐
│  file1.rs   │ f2  │
│             │     │
└─────────────┴─────┘

# 切换到 file2.rs（自动扩展）:
┌─────┬─────────────┐
│ f1  │  file2.rs   │
│     │             │
└─────┴─────────────┘
```

### 场景 2：三文件并排

```vim
:vsplit
:vsplit

# 均等布局:
┌──────┬──────┬──────┐
│  A   │  B   │  C   │
└──────┴──────┴──────┘

# 编辑 B（自动扩展）:
┌───┬──────────┬───┐
│ A │    B     │ C │
└───┴──────────┴───┘

# 编辑 C（自动扩展）:
┌───┬───┬──────────┐
│ A │ B │    C     │
└───┴───┴──────────┘
```

### 场景 3：编辑器 + 侧边栏

```vim
<leader>e          # NeoTree
:vsplit           # 分割编辑区

# 切换到编辑器（扩展）:
┌─────┬────────────────┐
│ Neo │    Editor      │
│ Tree│                │
└─────┴────────────────┘

# 切换到 NeoTree（扩展）:
┌────────────┬────────┐
│  NeoTree   │ Editor │
│            │        │
└────────────┴────────┘
```

### 场景 4：水平分割

```vim
:split            # 水平分割

# 初始:
┌────────────────┐
│     File 1     │
├────────────────┤
│     File 2     │
└────────────────┘

# 编辑 File 1（自动扩展）:
┌────────────────┐
│     File 1     │
│                │
│                │
├────────────────┤
│    File 2      │
└────────────────┘
```

## 💡 实用技巧

### 1. 专注模式

```vim
" 最大化当前窗口进行专注编辑
:WindowsMaximize

┌──────────────────────┐
│                      │
│    Full Window       │
│    (专注模式)         │
│                      │
└──────────────────────┘

" 完成后还原
:WindowsRestore
```

### 2. 参考代码工作流

```vim
" 左边参考，右边编辑
:vsplit reference.ts

# 编辑右边时（自动扩展）:
┌─────┬──────────────┐
│ Ref │   Writing    │
│     │              │
└─────┴──────────────┘

# 查看参考时（自动扩展）:
┌──────────────┬─────┐
│  Reference   │ Edit│
│              │     │
└──────────────┴─────┘
```

### 3. 调试布局

```vim
" 代码 + 终端
:split
:ToggleTerm

# 编辑代码时（扩展）:
┌─────────────────┐
│   Editor        │
│                 │
│                 │
├─────────────────┤
│   Terminal      │
└─────────────────┘

# 查看终端时（扩展）:
┌─────────────────┐
│   Editor        │
├─────────────────┤
│   Terminal      │
│                 │
│                 │
└─────────────────┘
```

## ⚙️ 配置选项

### 基础配置

```lua
{
  "anuvyklack/windows.nvim",
  dependencies = {
    "anuvyklack/middleclass",
    "anuvyklack/animation.nvim"
  },
  opts = {
    -- 自动调整
    autowidth = {
      enable = true,
      winwidth = 5,         -- 最小宽度
      filetype = {          -- 特殊文件类型
        help = 2,
      },
    },
    
    -- 忽略的窗口
    ignore = {
      buftype = { "quickfix" },
      filetype = { "NvimTree", "neo-tree", "undotree" }
    },
    
    -- 动画
    animation = {
      enable = true,
      duration = 200,       -- 动画时长（毫秒）
      fps = 60,            -- 帧率
      easing = "in_out_sine"  -- 缓动函数
    },
  },
}
```

### 扩展比例

```lua
opts = {
  autowidth = {
    enable = true,
    winwidth = 5,     -- 其他窗口最小5列
  },
  -- 当前窗口会占据剩余空间
}
```

### 禁用特定文件类型

```lua
opts = {
  ignore = {
    filetype = {
      "neo-tree",
      "NvimTree",
      "undotree",
      "aerial",
      "toggleterm",
    },
  },
}
```

## 🎨 动画效果

### 缓动函数选项

```lua
easing = "linear"          -- 线性
easing = "quadratic"       -- 二次方
easing = "cubic"           -- 三次方
easing = "quartic"         -- 四次方
easing = "quintic"         -- 五次方
easing = "exponential"     -- 指数
easing = "circle"          -- 圆形
easing = "sine"            -- 正弦
easing = "in_out_sine"     -- 正弦进出（推荐）
```

### 速度调整

```lua
animation = {
  duration = 100,   -- 快速（100ms）
  duration = 200,   -- 适中（200ms，推荐）
  duration = 300,   -- 慢速（300ms）
  duration = 0,     -- 禁用动画
}
```

## 🆚 对比手动调整

| 操作 | 手动调整 | windows.nvim |
|------|---------|-------------|
| 切换窗口 | 大小不变 | 自动扩展 |
| 聚焦效果 | 不明显 | 清晰可见 |
| 调整步骤 | Ctrl-w > > > | 自动 |
| 视觉效果 | 生硬 | 平滑动画 |

## 💡 与其他插件配合

### 1. 与 edgy.nvim

```
edgy 管理边栏位置
windows.nvim 调整编辑区大小

┌─────┬──────────┬─────┐
│ Neo │  Editor  │Aerial│
│ Tree│          │     │
└─────┴──────────┴─────┘

# 切换到编辑器（扩展）:
┌─────┬──────────────┬──┐
│ Neo │    Editor    │Ae│
│ Tree│              │  │
└─────┴──────────────┴──┘
```

### 2. 与 colorful-winsep

```
colorful-winsep 高亮分隔符
windows.nvim 调整窗口大小

切换前:
┌──────┃──────┃──────┐
│  A   ┃  B   │  C   │

切换到 B（扩展 + 分隔符高亮）:
┌───┃─────────┃───┐
│ A ┃    B    │ C │
    🔵高亮
```

### 3. 与 zen-mode

```
zen-mode 专注模式
windows.nvim 自动调整

普通模式：多窗口 + 自动调整
:ZenMode -> 单窗口专注
:ZenMode -> 恢复多窗口 + 自动调整
```

## 📊 性能

- ✅ **高效渲染**：只在窗口切换时触发
- ✅ **流畅动画**：60fps 不卡顿
- ✅ **低内存**：< 2MB 占用
- ✅ **无延迟**：切换响应迅速

## 🎯 适用场景

### ✅ 强烈推荐

- 经常多窗口工作
- 需要聚焦当前任务
- 喜欢视觉反馈
- 代码对比和参考

### ⚠️ 可能不需要

- 只用单窗口编辑
- 喜欢固定大小布局
- 对动画敏感
- 使用平铺窗口管理器

## 📚 总结

**windows.nvim 的价值**：
- 🎯 **自动聚焦** - 当前窗口自动扩展
- ✨ **动画美化** - 平滑的视觉过渡
- 🚀 **提升效率** - 减少手动调整
- 💎 **无感体验** - 自动化工作流

**最适合**：
- 多窗口编辑工作流
- 需要频繁切换窗口
- 追求流畅体验
- 专注当前任务

让窗口自动为你服务，专注于编码本身！🎯
