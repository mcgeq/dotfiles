# nvim-spectre - å…¨å±€æœç´¢å’Œæ›¿æ¢

## ğŸ“– ç®€ä»‹

`nvim-spectre` æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å…¨å±€æœç´¢å’Œæ›¿æ¢å·¥å…·ï¼Œæä¾›å¯è§†åŒ–ç•Œé¢è®©ä½ åœ¨æ›¿æ¢å‰é¢„è§ˆæ‰€æœ‰æ›´æ”¹ã€‚æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ã€é¡¹ç›®çº§æœç´¢ç­‰é«˜çº§åŠŸèƒ½ã€‚

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

- âœ… å…¨å±€æœç´¢å’Œæ›¿æ¢
- âœ… å¯è§†åŒ–é¢„è§ˆæ‰€æœ‰åŒ¹é…é¡¹
- âœ… æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼
- âœ… æ–‡ä»¶ç±»å‹è¿‡æ»¤
- âœ… è·¯å¾„è¿‡æ»¤ï¼ˆåŒ…å«/æ’é™¤ç‰¹å®šç›®å½•ï¼‰
- âœ… æ›¿æ¢å‰é¢„è§ˆ
- âœ… æ’¤é”€å•ä¸ªæ›¿æ¢

## âŒ¨ï¸ å¿«æ·é”®

### æ‰“å¼€ Spectre

| å¿«æ·é”® | åŠŸèƒ½ | è¯´æ˜ |
|--------|------|------|
| `<leader>sr` | æ‰“å¼€ Spectre é¢æ¿ | å…¨å±€æœç´¢æ›¿æ¢ |
| `<leader>sw` | æœç´¢å½“å‰å•è¯ | è‡ªåŠ¨å¡«å……å…‰æ ‡ä¸‹çš„å•è¯ |
| `<leader>sp` | åœ¨å½“å‰æ–‡ä»¶ä¸­æœç´¢ | é™å®šå½“å‰æ–‡ä»¶ |

### Spectre é¢æ¿å†…æ“ä½œ

| å¿«æ·é”® | åŠŸèƒ½ |
|--------|------|
| `<CR>` (Enter) | æ‰§è¡Œæ›¿æ¢ï¼ˆæ‰€æœ‰åŒ¹é…é¡¹ï¼‰|
| `<leader>rc` | æ›¿æ¢å…‰æ ‡ä¸‹çš„é¡¹ |
| `<leader>R` | æ›¿æ¢æ‰€æœ‰åŒ¹é…é¡¹ |
| `dd` | åˆ é™¤/æ’é™¤å½“å‰é¡¹ |
| `o` | è·³è½¬åˆ°æ–‡ä»¶ä½ç½® |
| `q` | å…³é—­ Spectre é¢æ¿ |
| `?` | æ˜¾ç¤ºå¸®åŠ©èœå• |

## ğŸ”¥ ä½¿ç”¨åœºæ™¯

### 1. åŸºæœ¬æœç´¢æ›¿æ¢

```
1. æŒ‰ <leader>sr æ‰“å¼€ Spectre
2. åœ¨ "Search" è¾“å…¥æ¡†è¾“å…¥è¦æœç´¢çš„å†…å®¹
3. åœ¨ "Replace" è¾“å…¥æ¡†è¾“å…¥æ›¿æ¢å†…å®¹
4. æŒ‰ <CR> æˆ– <leader>R æ‰§è¡Œæ›¿æ¢
```

**ç¤ºä¾‹**ï¼šå°†æ‰€æœ‰ `userName` é‡å‘½åä¸º `userId`

```
Search:  userName
Replace: userId
```

### 2. æ­£åˆ™è¡¨è¾¾å¼æœç´¢

```
Search:  user_(\w+)
Replace: person_$1
```

**æ•ˆæœ**ï¼š
```javascript
// æ›¿æ¢å‰
const user_name = "John";
const user_age = 30;

// æ›¿æ¢å
const person_name = "John";
const person_age = 30;
```

### 3. ç‰¹å®šæ–‡ä»¶ç±»å‹æœç´¢

åœ¨ "File" è¿‡æ»¤æ¡†ä¸­ï¼š

```
*.ts      # åªæœç´¢ TypeScript æ–‡ä»¶
*.{js,ts} # æœç´¢ JS å’Œ TS æ–‡ä»¶
*.vue     # åªæœç´¢ Vue æ–‡ä»¶
```

### 4. æ’é™¤ç‰¹å®šç›®å½•

åœ¨ "Path" è¿‡æ»¤æ¡†ä¸­ï¼š

```
!node_modules  # æ’é™¤ node_modules
!dist          # æ’é™¤ dist ç›®å½•
!**/test/**    # æ’é™¤æ‰€æœ‰ test ç›®å½•
```

### 5. æœç´¢å½“å‰å•è¯

```javascript
const userName = "John";
//    ^ å…‰æ ‡åœ¨ userName ä¸Š
// æŒ‰ <leader>sw è‡ªåŠ¨æ‰“å¼€ Spectre å¹¶æœç´¢ 'userName'
```

## ğŸ’¡ å®ç”¨æŠ€å·§

### 1. é‡æ„å˜é‡å

```typescript
// å°†æ•´ä¸ªé¡¹ç›®ä¸­çš„ oldName æ”¹ä¸º newName
<leader>sw  // åœ¨ oldName ä¸Š
# åœ¨ Replace æ¡†è¾“å…¥ newName
# é¢„è§ˆæ‰€æœ‰åŒ¹é…é¡¹
# æŒ‰ <CR> æ‰§è¡Œæ›¿æ¢
```

### 2. æ›´æ–° API ç«¯ç‚¹

```javascript
// æœç´¢æ‰€æœ‰ API è·¯å¾„å¹¶æ›´æ–°
Search:  /api/v1/
Replace: /api/v2/
```

### 3. ç§»é™¤è°ƒè¯•ä»£ç 

```javascript
// åˆ é™¤æ‰€æœ‰ console.log
Search:  console\.log\(.*\);?\n?
Replace: (ç•™ç©º)
```

### 4. æ‰¹é‡æ·»åŠ  async

```typescript
// å°†æ‰€æœ‰å‡½æ•°æ·»åŠ  async
Search:  function (\w+)\(
Replace: async function $1(
```

### 5. æ›´æ–° Import è·¯å¾„

```javascript
// æ›´æ–°æ‰€æœ‰ import è·¯å¾„
Search:  from '@/components/
Replace: from '@/components/new-folder/
```

## ğŸ¨ ç•Œé¢è¯´æ˜

```
â•­â”€ Spectre â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Search:  [è¾“å…¥æœç´¢å†…å®¹]                      â”‚
â”‚ Replace: [è¾“å…¥æ›¿æ¢å†…å®¹]                      â”‚
â”‚ Path:    [è·¯å¾„è¿‡æ»¤ï¼Œå¦‚ !node_modules]        â”‚
â”‚ File:    [æ–‡ä»¶è¿‡æ»¤ï¼Œå¦‚ *.ts]                 â”‚
â”‚                                             â”‚
â”‚ Results: 42 matches in 12 files             â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚ âœ“ src/utils/helper.ts (3 matches)          â”‚
â”‚   12: const userName = 'John';              â”‚
â”‚   25: function getUserName() {              â”‚
â”‚   30:   return userName;                    â”‚
â”‚                                             â”‚
â”‚ âœ“ src/components/User.tsx (2 matches)      â”‚
â”‚   15: <div>{userName}</div>                 â”‚
â”‚   20: const name = userName;                â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```

## âš™ï¸ é«˜çº§é…ç½®

### è‡ªå®šä¹‰æœç´¢å¼•æ“

é»˜è®¤ä½¿ç”¨ `rg`ï¼ˆripgrepï¼‰ï¼Œä¹Ÿå¯ä»¥é…ç½®ä¸ºå…¶ä»–å·¥å…·ï¼š

```lua
{
  "nvim-pack/nvim-spectre",
  opts = {
    default = {
      find = {
        cmd = "rg",
        options = {"--ignore-case"}
      }
    }
  }
}
```

### è‡ªå®šä¹‰å¿«æ·é”®

åœ¨ AstroNvim ä¸­ï¼š

```lua
{
  "nvim-pack/nvim-spectre",
  keys = {
    { "<leader>S", function() require("spectre").toggle() end, desc = "Toggle Spectre" },
    { "<leader>sw", function() require("spectre").open_visual({select_word=true}) end, desc = "Search current word" },
  }
}
```

## ğŸ“š æ³¨æ„äº‹é¡¹

### å®‰å…¨æç¤º

1. **å§‹ç»ˆå…ˆé¢„è§ˆ**ï¼šåœ¨æ‰§è¡Œæ›¿æ¢å‰ä»”ç»†æ£€æŸ¥æ‰€æœ‰åŒ¹é…é¡¹
2. **ä½¿ç”¨ Git**ï¼šæ›¿æ¢å‰ç¡®ä¿ä»£ç å·²æäº¤ï¼Œæ–¹ä¾¿å›æ»š
3. **å°èŒƒå›´æµ‹è¯•**ï¼šå…ˆåœ¨å°èŒƒå›´æµ‹è¯•æ­£åˆ™è¡¨è¾¾å¼
4. **æ’é™¤æ–‡ä»¶**ï¼šä½¿ç”¨ Path å’Œ File è¿‡æ»¤é¿å…ä¿®æ”¹ä¸éœ€è¦çš„æ–‡ä»¶

### æ€§èƒ½ä¼˜åŒ–

1. ä½¿ç”¨æ–‡ä»¶è¿‡æ»¤å‡å°‘æœç´¢èŒƒå›´
2. æ’é™¤ `node_modules`ã€`dist` ç­‰å¤§å‹ç›®å½•
3. å¯¹å¤§å‹é¡¹ç›®ä½¿ç”¨æ›´å…·ä½“çš„æœç´¢è¯

## ğŸ†š å¯¹æ¯”å…¶ä»–å·¥å…·

| ç‰¹æ€§ | Spectre | åŸç”Ÿ `:s///` | sed/awk |
|------|---------|-------------|---------|
| å¯è§†åŒ–é¢„è§ˆ | âœ… | âŒ | âŒ |
| è·¨æ–‡ä»¶æœç´¢ | âœ… | âŒ | âœ… |
| æ˜“ç”¨æ€§ | â­â­â­â­â­ | â­â­â­ | â­â­ |
| æ­£åˆ™æ”¯æŒ | âœ… | âœ… | âœ… |
| æ’¤é”€å•é¡¹ | âœ… | âŒ | âŒ |

## ğŸ”— ç›¸å…³èµ„æº

- [GitHub - nvim-spectre](https://github.com/nvim-pack/nvim-spectre)
- [AstroCommunity æ’ä»¶é¡µ](https://github.com/AstroNvim/astrocommunity/tree/main/lua/astrocommunity/search/nvim-spectre)
- [Ripgrep æ–‡æ¡£](https://github.com/BurntSushi/ripgrep)
