#+title: Emacs Configuration
#+author: mcge
#+email: mcgeq@outlook.com
#+date: 2025-02-16
#+language: en

* Welcome to My Emacs Configuration

This is a modern, modular Emacs configuration written using literate programming
with Org Mode. It's designed for Emacs 29+ with extensive language support,
LSP integration, and productivity features.

* Philosophy

** Built-in First
   Reconfigure Emacs to use as many built-in features as possible and use fewer
   unnecessary plugins.

** Modular Design
   Configuration split into logical modules organized by functionality

** Literate Programming
   Written in Org Mode for easy documentation and maintenance

** Performance Optimized
   Lazy loading, fast startup, and minimal overhead

* ğŸ¯ Features

** Core Stack
   - Emacs 29+ with tree-sitter support
   - LSP Bridge for language server integration
   - Vertico + Marginalia + Embark for completions
   - Magit for Git operations

** Language Support
   Full development support for:
   - *Systems*: C/C++, Rust (rust-analyzer), Lua
   - *Web*: TypeScript, JavaScript, HTML/CSS, JSX/React
   - *Dynamic*: Python, Bash
   - *Markup*: Markdown, Org Mode

** Key Features
   - [[https://github.com/minad/vertico][Vertico]]: Modern minibuffer completions
   - [[https://github.com/minad/marginalia][Marginalia]]: Rich annotations
   - [[https://github.com/oantolin/embark][Embark]]: Contextual actions
   - [[https://github.com/manateelazycat/lsp-bridge][LSP Bridge]]: Blazing fast LSP
   - [[https://magit.vc/][Magit]]: Git interface
   - [[https://github.com/manateelazycat/blink-search][Blink-search]]: Universal search
   - [[https://github.com/manateelazycat/color-rg][Color-rg]]: Fast grep
   - [[https://github.com/manateelazycat/awesome-tray][Awesome-tray]]: Lightweight status display
   - [[https://github.com/manateelazycat/emacs-rime][Rime]]: Chinese input
   - [[https://github.com/justbur/emacs-which-key][Which-key]]: å¿«æ·é”®æç¤º â­
   - [[https://github.com/abo-abo/ace-window][Ace-window]]: å¿«é€Ÿçª—å£åˆ‡æ¢ â­
   - [[https://github.com/abo-abo/avy][Avy]]: å¿«é€Ÿè·³è½¬å¯¼èˆª â­
   - *Org Mode V2.1*: æ–°æ¨¡å—åŒ–é…ç½®ç³»ç»Ÿï¼ˆç»Ÿä¸€å˜é‡ã€æ™ºèƒ½åŠ è½½ï¼‰

* ğŸ“¦ Installation

** Prerequisites
   - Emacs 29+ (recommended) or Emacs 28+ with tree-sitter
   - Git for package management
   - Node.js for lsp-bridge
   - (Optional) Universal Ctags for symbol navigation

** Quick Install

*** Step 1: Clone Repository
    #+begin_src bash
    git clone <repository-url> ~/dotfiles
    cd ~/dotfiles/emacs
    #+end_src

*** Step 2: Initialize Git Submodules
    #+begin_src bash
    # Using make (recommended)
    make init
    
    # Or directly
    git submodule update --init --recursive
    #+end_src

*** Step 3: Create User Configuration
    #+begin_src bash
    # Copy template to custom.el
    cp custom-example.el custom.el
    
    # Edit your settings (optional)
    # emacs custom.el
    #+end_src

*** Step 4: Generate Configuration
    #+begin_src bash
    # Generate Emacs Lisp from Org files
    make generate
    #+end_src
    
    This compiles the Org Mode files in =config-org/= to Emacs Lisp files in
    =site-lisp/config/=.

*** Step 5: Link to Emacs

**** Option A: Symlink (Recommended)
     #+begin_src bash
     # Linux/macOS
     ln -s ~/dotfiles/emacs ~/.emacs.d
     
     # Windows (PowerShell as Administrator)
     New-Item -ItemType SymbolicLink -Path $env:USERPROFILE\.emacs.d -Target D:\config\dotfiles\emacs
     #+end_src

**** Option B: Manual Load
     Add to your =~/.emacs= or =~/.emacs.d/init.el=:
     #+begin_src emacs-lisp
     (load-file "~/dotfiles/emacs/site-lisp/config/init.el")
     #+end_src

*** Step 6: First Launch
    #+begin_src bash
    emacs
    #+end_src
    
    Emacs will automatically compile the configuration on first run.

** Troubleshooting

   If you encounter issues:
   
   #+begin_src bash
   # Check package status
   make st
   
   # Clean and regenerate
   make clean
   make generate
   
   # Check Emacs version
   emacs --version  # Should be 28+ (29+ recommended)
   
   # View all commands
   make h
   #+end_src

* ğŸ—‚ï¸ Configuration Structure

#+begin_src text
emacs/
â”œâ”€â”€ Makefile                     # Build system for Org â†’ EL compilation
â”œâ”€â”€ README.org                   # This file
â”œâ”€â”€ config-org/                  # Source: Org Mode literate config
â”‚   â”œâ”€â”€ init.org                 # Main entry point
â”‚   â”œâ”€â”€ core/                    # Core configuration
â”‚   â”‚   â”œâ”€â”€ init-paths.org       # Path management
â”‚   â”‚   â”œâ”€â”€ init-loadpath.org    # Load-path setup
â”‚   â”‚   â”œâ”€â”€ init-const.org       # Constants
â”‚   â”‚   â”œâ”€â”€ init-font.org        # Font configuration
â”‚   â”‚   â”œâ”€â”€ init-function.org    # Custom functions
â”‚   â”‚   â”œâ”€â”€ init-builtin.org     # Built-in features
â”‚   â”‚   â””â”€â”€ init-verify.org      # Configuration validation
â”‚   â”œâ”€â”€ ui/                      # User interface
â”‚   â”œâ”€â”€ editor/                  # Editor features
â”‚   â”œâ”€â”€ completion/              # Completions
â”‚   â”œâ”€â”€ tools/                   # Tools
â”‚   â”œâ”€â”€ lang/                    # Language support
â”‚   â”œâ”€â”€ org/                     # Org Mode (æ–°æ¨¡å—åŒ–ç³»ç»Ÿ V2.1)
â”‚   â”‚   â”œâ”€â”€ init-org-vars.org    # å˜é‡å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ init-org-loader.org  # é…ç½®åŠ è½½å™¨
â”‚   â”‚   â”œâ”€â”€ init-org.org         # æ ¸å¿ƒé…ç½®
â”‚   â”‚   â”œâ”€â”€ init-org-agenda.org  # Agenda
â”‚   â”‚   â””â”€â”€ init-capture-hugo.org # Capture & Hugo
â”‚   â”œâ”€â”€ docs/                    # Documentation
â”‚   â””â”€â”€ etc/                     # Miscellaneous
â”œâ”€â”€ site-lisp/                   # Generated: Compiled EL files
â”‚   â”œâ”€â”€ config/                  # Same structure as config-org/
â”‚   â””â”€â”€ extensions/              # Git submodules
â”‚       â”œâ”€â”€ lsp/                 # LSP bridge
â”‚       â”œâ”€â”€ magit/               # Git interface
â”‚       â”œâ”€â”€ vertico/             # Completions
â”‚       â”œâ”€â”€ org/                 # Org Mode
â”‚       â”œâ”€â”€ blink-search/        # Search
â”‚       â””â”€â”€ ...                  # Other extensions
â”œâ”€â”€ snippets/                    # Snippets
â””â”€â”€ langservers/                 # Language server configs
#+end_src

* âš™ï¸ Configuration Management

** Makefile Commands

*** Configuration
    #+begin_src bash
    make generate        # Generate config from Org files
    make clean           # Clean generated files
    make generate-elc    # Generate and byte-compile
    #+end_src

*** Package Management
    #+begin_src bash
    make init            # Initialize Git Submodules (first time)
    make st              # Check package status (with remote check)
    make up              # Update packages safely (with branch check)
    make lock-packages   # Lock current package versions
    make restore-packages # Restore to locked versions
    #+end_src

*** Testing
    #+begin_src bash
    make test            # Run all tests
    make test-verbose    # Run tests with verbose output
    #+end_src

*** Quick Reference
    #+begin_src bash
    make h               # Show help (all commands)
    #+end_src

    Shortcuts: =init=, =st=, =up=, =h=

** User Configuration

*** Custom Settings
    All user-specific settings should go in =custom.el= (automatically loaded):

    #+begin_src emacs-lisp
    ;; Copy template
    ;; make init
    ;; cp custom-example.el custom.el
    
    ;; Then edit custom.el with your settings:
    
    ;; Module declarations (optional, declarative style)
    (mcg! 
     :core                    ; Core modules
     :ui                      ; UI (awesome-tray enabled by default)
     :completion vertico embark
     :lang lsp-bridge (rust lua typescript))
    
    ;; Custom settings
    (setq mcg-theme 'doom-one)
    (setq mcg-font-size 14)
    #+end_src

    Note: =custom.el= is gitignored (personal settings)

** Module System

   Configuration is organized into phases:
   
   1. *Phase 1*: Core Infrastructure
      - Path management
      - Load-path setup
      - Configuration validation
      - Constants and utilities
   
   2. *Phase 2*: UI and Themes
      - Doom modeline
      - Awesome tray
      - UI customization
   
   3. *Phase 3*: Editor Enhancement
      - Line numbers
      - Indentation
      - Tree-sitter
      - Auto-save
      - Ace-window (çª—å£åˆ‡æ¢)
      - Avy (å¿«é€Ÿè·³è½¬)
      - Which-key (å¿«æ·é”®æç¤º)
   
   4. *Phase 4*: Completions
      - Vertico
      - Marginalia
      - Embark
      - Yasnippet
   
   5. *Phase 5*: Keybindings
      - Global bindings
      - Mode-specific bindings
   
   6. *Phase 6*: LSP and Languages* (delayed)
      - lsp-bridge
      - Language-specific configs
   
   7. *Phase 7*: Org and Docs* (delayed)
      - Org Mode (æ–°æ¨¡å—åŒ–åŠ è½½å™¨)
      - init-org-loader (æ™ºèƒ½ä¾èµ–ç®¡ç†)
      - Markdown
      - Documentation tools

** Adding New Modules

   #+begin_example org
   1. Create an Org file in the appropriate config-org/ directory
   2. Use Org Babel with :tangle directive:
      * module-name.el
      :PROPERTIES:
      :HEADER-ARGS: :tangle path/to/module-name.el :lexical t
      :END:
      
      #+BEGIN_SRC emacs-lisp
      ;; Your code here
      #+END_SRC
   3. Add (require 'module-name) to the appropriate phase in init.org
   4. Run make generate
   #+end_example

** Extension Registry V2 â­

   æœ¬é…ç½®é‡‡ç”¨å¢å¼ºçš„æ‰©å±•æ³¨å†Œè¡¨ç³»ç»Ÿï¼ˆV2ï¼‰ï¼Œæä¾›ä¾èµ–ç®¡ç†ã€ç‰ˆæœ¬è¿½è¸ªå’Œå…ƒæ•°æ®æ”¯æŒã€‚

*** ç‰¹æ€§

    - *ä¾èµ–ç®¡ç†* :: è‡ªåŠ¨è§£æå’ŒåŠ è½½æ‰©å±•ä¾èµ–
    - *ç‰ˆæœ¬è¿½è¸ª* :: è®°å½•æ‰©å±•ç‰ˆæœ¬å’Œä¸Šæ¸¸ä¿¡æ¯
    - *åˆ†ç±»ç»„ç»‡* :: æŒ‰åŠŸèƒ½åˆ†ç±»ç®¡ç†æ‰©å±•
    - *å»¶è¿ŸåŠ è½½* :: éæ ¸å¿ƒæ‰©å±•å»¶è¿ŸåŠ è½½ä»¥æå‡å¯åŠ¨é€Ÿåº¦
    - *å¾ªç¯ä¾èµ–æ£€æµ‹* :: è‡ªåŠ¨æ£€æµ‹å¹¶è­¦å‘Šå¾ªç¯ä¾èµ–

*** æ‰©å±•ç±»åˆ«

    | ç±»åˆ«       | æè¿°                 | åŠ è½½é˜¶æ®µ |
    |------------+----------------------+----------|
    | core       | æ ¸å¿ƒåº“å’ŒåŸºç¡€è®¾æ–½     | ç«‹å³     |
    | ui         | ç”¨æˆ·ç•Œé¢å’Œä¸»é¢˜       | ç«‹å³     |
    | completion | è¡¥å…¨å’Œé€‰æ‹©æ¡†æ¶       | ç«‹å³     |
    | editor     | ç¼–è¾‘å™¨åŠŸèƒ½å¢å¼º       | ç«‹å³     |
    | search     | æœç´¢å’Œå¯¼èˆªå·¥å…·       | ç«‹å³     |
    | utils      | é€šç”¨å®ç”¨å·¥å…·         | ç«‹å³     |
    | snippets   | ä»£ç ç‰‡æ®µç³»ç»Ÿ         | ç«‹å³     |
    | input      | è¾“å…¥æ³•å’Œè¾“å…¥å¢å¼º     | ç«‹å³     |
    | git        | ç‰ˆæœ¬æ§åˆ¶å·¥å…·         | å»¶è¿Ÿ     |
    | lsp        | LSPå’Œè¯­è¨€æ”¯æŒ        | å»¶è¿Ÿ     |
    | org        | Org Modeç”Ÿæ€ç³»ç»Ÿ     | å»¶è¿Ÿ     |
    | docs       | æ–‡æ¡£ç¼–è¾‘å’Œé¢„è§ˆ       | å»¶è¿Ÿ     |

*** ç®¡ç†å‘½ä»¤

    #+begin_src emacs-lisp
    ;; æŸ¥è¯¢æ‰©å±•ä¿¡æ¯
    M-x mcg-info-extension       ; äº¤äº’å¼æŸ¥çœ‹æ‰©å±•è¯¦æƒ…
    
    ;; æœç´¢æ‰©å±•
    M-x mcg-search-extension     ; æ¨¡ç³Šæœç´¢æ‰©å±•ï¼ˆæŒ‰åç§°æˆ–ç±»åˆ«ï¼‰
    
    ;; æŸ¥çœ‹åˆ†ç±»çŠ¶æ€
    M-x mcg-display-categories-status  ; æ˜¾ç¤ºæ‰€æœ‰ç±»åˆ«çš„åŠ è½½çŠ¶æ€
    
    ;; éªŒè¯é…ç½®
    M-x mcg-validate-all         ; æ‰§è¡Œå®Œæ•´é…ç½®éªŒè¯
    M-x mcg-validate-extensions  ; éªŒè¯æ‰©å±•ç›®å½•å­˜åœ¨
    M-x mcg-validate-dependencies ; éªŒè¯ä¾èµ–å…³ç³»
    
    ;; æ£€æŸ¥å¾ªç¯ä¾èµ–
    M-x mcg-check-circular-dependencies
    #+end_src

** Version Management (ç‰ˆæœ¬ç®¡ç†) â­

   æ”¯æŒé”å®šå’Œæ¢å¤ Git Submodule ç‰ˆæœ¬ï¼Œç¡®ä¿é…ç½®å¯å¤ç°ã€‚

*** é”å®šç‰ˆæœ¬

    #+begin_src bash
    # ä½¿ç”¨ Makefile
    make lock-packages
    
    # æˆ–ä½¿ç”¨ PowerShell è„šæœ¬
    powershell -File scripts/Save-PackageVersions.ps1
    #+end_src

    è¿™ä¼šç”Ÿæˆ =site-lisp/packages-lock.el= æ–‡ä»¶ï¼ŒåŒ…å«ï¼š
    - æ‰€æœ‰ submodule çš„ commit hash
    - åˆ†æ”¯ä¿¡æ¯
    - é”å®šæ—¶é—´æˆ³
    - Emacs ç‰ˆæœ¬å’Œå¹³å°ä¿¡æ¯

*** æ¢å¤ç‰ˆæœ¬

    #+begin_src bash
    # ä½¿ç”¨ Makefile
    make restore-packages
    
    # æˆ–ä½¿ç”¨ PowerShell è„šæœ¬
    powershell -File scripts/Restore-PackageVersions.ps1
    #+end_src

*** Emacs å†…å‘½ä»¤

    #+begin_src emacs-lisp
    ;; é”å®šå½“å‰ç‰ˆæœ¬
    M-x mcg-lock-packages
    
    ;; æ¢å¤åˆ°é”å®šç‰ˆæœ¬
    M-x mcg-restore-packages
    
    ;; å›æ»šå•ä¸ªåŒ…
    M-x mcg-rollback-package
    
    ;; æ¯”è¾ƒå½“å‰ç‰ˆæœ¬ä¸é”å®šç‰ˆæœ¬
    M-x mcg-compare-versions
    #+end_src

** Cross-Platform Support (è·¨å¹³å°æ”¯æŒ) â­

   é…ç½®è‡ªåŠ¨æ£€æµ‹è¿è¡Œå¹³å°å¹¶é€‚é…ç›¸åº”è®¾ç½®ã€‚

*** æ”¯æŒçš„å¹³å°

    - Windows (PowerShell/CMD)
    - macOS
    - Linux
    - BSD

*** å¹³å°æ£€æµ‹

    #+begin_src emacs-lisp
    ;; æ£€æµ‹å½“å‰å¹³å°
    M-x mcg-display-platform-info
    
    ;; å¹³å°åˆ¤æ–­å‡½æ•°
    (mcg-platform-windows-p)  ; æ˜¯å¦ Windows
    (mcg-platform-macos-p)    ; æ˜¯å¦ macOS
    (mcg-platform-linux-p)    ; æ˜¯å¦ Linux
    (mcg-platform-unix-like-p) ; æ˜¯å¦ç±» Unix
    #+end_src

*** å¤–éƒ¨å·¥å…·æ£€æµ‹

    #+begin_src emacs-lisp
    ;; æ£€æµ‹å¤–éƒ¨å·¥å…·
    M-x mcg-detect-external-tools
    
    ;; æ£€æŸ¥å·¥å…·æ˜¯å¦å¯ç”¨
    (mcg-tool-available-p 'git)
    (mcg-tool-available-p 'ripgrep)
    (mcg-tool-available-p 'python)
    
    ;; è·å–å·¥å…·è·¯å¾„
    (mcg-get-tool-path 'git)
    #+end_src

*** ä¼˜é›…é™çº§

    å½“å¹³å°ç‰¹å®šåŠŸèƒ½ä¸å¯ç”¨æ—¶ï¼Œç³»ç»Ÿä¼šï¼š
    1. æ˜¾ç¤ºè­¦å‘Šä¿¡æ¯
    2. æä¾›æ›¿ä»£æ–¹æ¡ˆå»ºè®®
    3. ç»§ç»­åŠ è½½å…¶ä»–åŠŸèƒ½

    #+begin_src emacs-lisp
    ;; æŸ¥çœ‹é™çº§è­¦å‘Š
    M-x mcg-display-degradation-warnings
    #+end_src

* âŒ¨ï¸ Key Bindings

æœ¬é…ç½®é‡‡ç”¨æ¨¡å—åŒ–ã€ç¬¦åˆ Emacs æ ‡å‡†çš„å¿«æ·é”®è®¾è®¡ã€‚æ‰€æœ‰è‡ªå®šä¹‰ç»‘å®šéƒ½ä½¿ç”¨ =C-c= å‰ç¼€ï¼ˆç”¨æˆ·ä¿ç•™åŒºï¼‰ï¼Œå¹¶æä¾› which-key æè¿°ä»¥ä¾¿å‘ç°ã€‚

** å¿«æ·é”®æŸ¥è¯¢
   - =C-h K= :: æ˜¾ç¤ºå¿«æ·é”®é€ŸæŸ¥è¡¨ï¼ˆå®Œæ•´åˆ—è¡¨ï¼‰
   - =C-c w ?= :: Which-key ä½¿ç”¨æç¤º
   - =C-c w p= :: æ˜¾ç¤ºæ‰€æœ‰å®šä¹‰çš„å‰ç¼€
   - =C-c w m= :: æ˜¾ç¤ºå½“å‰ major mode çš„å¿«æ·é”®
   - =C-h b= :: Emacs æ ‡å‡†ï¼šæ˜¾ç¤ºæ‰€æœ‰ç»‘å®š

** LSP / ä»£ç å¯¼èˆª (æ ‡å‡†ç»‘å®š)

*** å¯¼èˆª
    - =M-.= :: è·³è½¬åˆ°å®šä¹‰ (lsp-bridge-find-def)
    - =M-,= :: è¿”å› (lsp-bridge-find-def-return)
    - =M-?= :: æŸ¥æ‰¾å¼•ç”¨ (lsp-bridge-find-references)
    - =C-M-.= :: åœ¨å¦ä¸€çª—å£æ‰“å¼€å®šä¹‰

*** æ–‡æ¡£
    - =C-h .= :: æ˜¾ç¤ºæ–‡æ¡£ (lsp-bridge-popup-documentation)
    - =C-h ,= :: æ˜¾ç¤ºå‡½æ•°ç­¾å (lsp-bridge-show-signature)
    - =C-h <up>= :: æ–‡æ¡£å‘ä¸Šæ»šåŠ¨
    - =C-h <down>= :: æ–‡æ¡£å‘ä¸‹æ»šåŠ¨

*** é‡æ„ (C-c r å‰ç¼€)
    - =C-c r r= :: é‡å‘½åç¬¦å· (lsp-bridge-rename)
    - =C-c r i= :: ä»£ç æ“ä½œ (lsp-bridge-code-action)
    - =C-c r f= :: æ ¼å¼åŒ–ä»£ç  (lsp-bridge-code-format)
    - =C-c r l= :: æŸ¥æ‰¾å®ç° (lsp-bridge-find-impl)
    - =C-c r s= :: å·¥ä½œåŒºç¬¦å·åˆ—è¡¨

*** è¯Šæ–­ (M-g å‰ç¼€ - Emacs æ ‡å‡†)
    - =M-g n= :: ä¸‹ä¸€ä¸ªé”™è¯¯ (lsp-bridge-diagnostic-jump-next)
    - =M-g p= :: ä¸Šä¸€ä¸ªé”™è¯¯ (lsp-bridge-diagnostic-jump-prev)
    - =M-g l= :: é”™è¯¯åˆ—è¡¨ (lsp-bridge-diagnostic-list)

** çª—å£æ“ä½œ / Window (C-c w å‰ç¼€) â­

*** çª—å£åˆ‡æ¢ (Ace-window)
    - =M-O= :: å¿«é€Ÿåˆ‡æ¢çª—å£ (Shift+M-o)
    - =C-x o= :: åˆ‡æ¢çª—å£ (æ›¿æ¢é»˜è®¤)
    - =C-c w w= :: åˆ‡æ¢çª—å£
    - =C-c w d= :: åˆ é™¤çª—å£
    - =C-c w s= :: äº¤æ¢çª—å£
    - =C-c w m= :: ç§»åŠ¨çª—å£
    - =C-c w o= :: åªä¿ç•™å½“å‰çª—å£
    - =C-c w v= :: å‚ç›´åˆ†å‰²
    - =C-c w h= :: æ°´å¹³åˆ†å‰²

*** çª—å£å¸ƒå±€æ’¤é”€ (Winner-mode)
    - =C-c <left>= :: æ’¤é”€çª—å£å¸ƒå±€
    - =C-c <right>= :: é‡åšçª—å£å¸ƒå±€

** å¿«é€Ÿè·³è½¬ / Avy (M-g å‰ç¼€) â­

*** åŸºç¡€è·³è½¬
    - =C-;= :: è·³è½¬åˆ°å­—ç¬¦ (è¾“å…¥1ä¸ªå­—ç¬¦)
    - =C-'= :: è·³è½¬åˆ°å­—ç¬¦ (è¾“å…¥2ä¸ªå­—ç¬¦ï¼Œæ›´ç²¾ç¡®)
    - =M-g w= :: è·³è½¬åˆ°å•è¯
    - =M-g g= :: è·³è½¬åˆ°è¡Œ
    - =M-g c= :: å®šæ—¶è·³è½¬
    - =M-g j= :: è·³è½¬åˆ°å½“å‰è¡Œå­—ç¬¦

*** é«˜çº§æ“ä½œ
    - =M-g y= :: å¤åˆ¶è·³è½¬ä½ç½®çš„è¡Œ
    - =M-g m= :: ç§»åŠ¨è·³è½¬ä½ç½®çš„è¡Œ
    - =M-g k= :: åˆ é™¤è·³è½¬ä½ç½®çš„è¡Œ
    - =M-g Y= :: å¤åˆ¶åŒºåŸŸ (å½“å‰ä½ç½®åˆ°è·³è½¬ä½ç½®)
    - =M-g K= :: åˆ é™¤åŒºåŸŸ
    - =M-g (= :: è·³è½¬åˆ°å¼€æ‹¬å·
    - =M-g )= :: è·³è½¬åˆ°é—­æ‹¬å·

** Git / Magit (C-c g å‰ç¼€)

*** ä¸»è¦å‘½ä»¤
    - =C-x g= :: Magit çŠ¶æ€ (æ ‡å‡†ç»‘å®š)
    - =C-x M-g= :: Magit dispatch
    - =C-c g s= :: Magit çŠ¶æ€ (magit-status)
    - =C-c g l= :: Git æ—¥å¿— (magit-log)
    - =C-c g d= :: Magit dispatch (magit-dispatch)
    - =C-c g f= :: æ–‡ä»¶æ“ä½œ (magit-file-dispatch)
    - =C-c g ?= :: Git èœå• (mcg-git-menu)

*** åˆ†æ”¯æ“ä½œ (C-c g b å­å‰ç¼€)
    - =C-c g b b= :: åˆ›å»ºåˆ†æ”¯
    - =C-c g b r= :: é‡å‘½ååˆ†æ”¯
    - =C-c g b d= :: åˆ é™¤åˆ†æ”¯

*** è¿œç¨‹æ“ä½œ (C-c g r å­å‰ç¼€)
    - =C-c g r a= :: æ·»åŠ è¿œç¨‹
    - =C-c g r r= :: é‡å‘½åè¿œç¨‹
    - =C-c g r d= :: åˆ é™¤è¿œç¨‹

*** æ¨é€/æ‹‰å–
    - =C-c g p= :: Push (magit-push)
    - =C-c g f= :: Pull (magit-pull)

*** å­æ¨¡å— (C-c g m å­å‰ç¼€)
    - =C-c g m a= :: æ·»åŠ å­æ¨¡å—
    - =C-c g m r= :: åˆ é™¤å­æ¨¡å—
    - =C-c g m u= :: æ›´æ–°å­æ¨¡å—

*** æ–‡ä»¶æ“ä½œ (C-c g F å­å‰ç¼€)
    - =C-c g F r= :: é‡å‘½åæ–‡ä»¶
    - =C-c g F d= :: åˆ é™¤æ–‡ä»¶

** æœç´¢ / Search (C-c s å‰ç¼€)

*** Buffer å†…æœç´¢
    - =C-c s l= :: æœç´¢è¡Œ (consult-line)
    - =C-c s i= :: Imenu å¯¼èˆª (consult-imenu)
    - =C-c s m= :: Mark å¯¼èˆª (consult-mark)

*** é¡¹ç›®æœç´¢ï¼ˆcolor-rg - æ— ä¸­æ–‡ç¼–ç é—®é¢˜ï¼‰
    - =C-c s g= :: æœç´¢å†…å®¹ (color-rg-search-input)
    - =C-c s G= :: é¡¹ç›®å†…æœç´¢å†…å®¹ (color-rg-search-input-in-project)
    - =C-c s s= :: æœç´¢ç¬¦å· (color-rg-search-symbol)
    - =C-c s S= :: é¡¹ç›®å†…æœç´¢ç¬¦å· (color-rg-search-symbol-in-project)
    - =C-c s .= :: å½“å‰æ–‡ä»¶æœç´¢ç¬¦å· (color-rg-search-symbol-in-current-file)
    - =C-c s ,= :: å½“å‰æ–‡ä»¶æœç´¢å†…å®¹ (color-rg-search-input-in-current-file)

*** Blink Searchï¼ˆå¿«é€Ÿæœç´¢ï¼‰
    - =C-c s B= :: å¤šåç«¯æœç´¢ï¼ˆä¸»å…¥å£ï¼‰
    - =C-c s D= :: å½“å‰ç›®å½•æ–‡ä»¶ï¼ˆç«‹å³æ˜¾ç¤ºï¼‰
    - =C-c s P= :: é¡¹ç›®æ–‡ä»¶ï¼ˆç«‹å³æ˜¾ç¤ºï¼‰

*** Buffer/æ–‡ä»¶åˆ‡æ¢
    - =C-c s b= :: åˆ‡æ¢ Buffer (consult-buffer)
    - =C-c s r= :: æœ€è¿‘æ–‡ä»¶ (consult-recent-file)
    - =C-c s o= :: Org æ ‡é¢˜å¯¼èˆª (mcg/consult-find-org-headings)

*** èœå•
    - =C-c s ?= :: æœç´¢èœå• (transient)

*** Embark (ä¸Šä¸‹æ–‡æ“ä½œ)
    - =C-.= :: Embark act (å¯¹å½“å‰é¡¹æ‰§è¡Œæ“ä½œ)
    - =C-,= :: Embark dwim (æ™ºèƒ½æ“ä½œ)

*** ğŸ’¡ æœç´¢ä½¿ç”¨æç¤º

**** å·¥å…·é€‰æ‹©ï¼ˆæ–¹æ¡ˆ Bï¼šæ··åˆé…ç½®ï¼‰
    - *Buffer å†…æœç´¢*ï¼šä½¿ç”¨ =consult-line/imenu= ï¼ˆæœ€ä½³ä½“éªŒï¼‰
    - *æ–‡ä»¶æŸ¥æ‰¾*ï¼šä½¿ç”¨ =blink-search= ï¼ˆç«‹å³æ˜¾ç¤ºï¼Œæ— ç¼–ç é—®é¢˜ï¼‰
    - *å†…å®¹/ç¬¦å·æœç´¢*ï¼šä½¿ç”¨ =color-rg= ï¼ˆä¸“ä¸šæœç´¢ï¼ŒUTF-8 å‹å¥½ï¼‰

**** Color-rg ä½¿ç”¨è¯´æ˜
    - äº¤äº’å¼æœç´¢ç•Œé¢ï¼Œæ”¯æŒå®æ—¶ç¼–è¾‘ç»“æœ
    - æ™ºèƒ½ç¬¦å·è¯†åˆ«ï¼Œè‡ªåŠ¨é«˜äº®åŒ¹é…
    - æ”¯æŒé¡¹ç›®èŒƒå›´å’Œæ–‡ä»¶èŒƒå›´æœç´¢
    - *å®Œç¾çš„ä¸­æ–‡æ”¯æŒ*ï¼Œæ— ç¼–ç é—®é¢˜

**** Blink Search ä½¿ç”¨è¯´æ˜
    - =C-c s B= æ‰“å¼€åï¼ŒæŒ‰ =TAB= åˆ‡æ¢ä¸åŒåç«¯
    - ç«‹å³æ˜¾ç¤ºæ–‡ä»¶åˆ—è¡¨ï¼Œæ— éœ€ç­‰å¾…è¾“å…¥
    - Python åç«¯ï¼ŒUTF-8 åŸç”Ÿæ”¯æŒ
    - éœ€è¦ Python 3 å’Œä¾èµ–ï¼š~pip3 install epc orjson rapidfuzz~

**** ä¾èµ–å·¥å…·
    - =color-rg= å’Œ =blink-search= éœ€è¦ =ripgrep= : ~scoop install ripgrep~
    - =blink-search= éœ€è¦ Python 3 ç¯å¢ƒ
    - *å·²ç§»é™¤*ï¼š=consult-find= ï¼ˆWindows ç¼–ç é—®é¢˜ï¼‰å’Œ =consult-ripgrep= ï¼ˆcolor-rg æ›´å¥½ï¼‰

** æ ‡ç­¾é¡µ / Tabs (C-c t å‰ç¼€)

*** å¯¼èˆª
    - =C-c t n= :: ä¸‹ä¸€ä¸ªæ ‡ç­¾é¡µ
    - =C-c t p= :: ä¸Šä¸€ä¸ªæ ‡ç­¾é¡µ
    - =C-c t f= :: ç¬¬ä¸€ä¸ªæ ‡ç­¾é¡µ
    - =C-c t l= :: æœ€åä¸€ä¸ªæ ‡ç­¾é¡µ

*** ç®¡ç†
    - =C-c t k= :: å…³é—­å½“å‰æ ‡ç­¾é¡µ
    - =C-c t o= :: å…³é—­å…¶ä»–æ ‡ç­¾é¡µ
    - =C-c t K= :: å…³é—­æ‰€æœ‰æ ‡ç­¾é¡µ

*** å¿«é€Ÿè®¿é—®
    - =C-c t 1/2/3= :: è·³è½¬åˆ°æ ‡ç­¾é¡µ 1/2/3

** Org Mode / ç¬”è®° (C-c n å‰ç¼€)

*** æ•è·å’Œè®®ç¨‹
    - =C-c n c= :: Org capture (å¿«é€Ÿæ•è·)
    - =C-c n a= :: Org agenda (è®®ç¨‹è§†å›¾)
    - =C-c n l= :: å­˜å‚¨é“¾æ¥ (org-store-link)
    - =C-c n t= :: Todo åˆ—è¡¨ (org-todo-list)

*** Org Buffer å†…ï¼ˆæ ‡å‡†å¿«æ·é”®ï¼‰
    - =C-c C-w= :: Org refile (é‡æ–°å½’æ¡£)
    - =C-c C-t= :: åˆ‡æ¢ TODO çŠ¶æ€
    - =C-c C-s= :: è®¾ç½®è®¡åˆ’æ—¶é—´
    - =C-c C-d= :: è®¾ç½®æˆªæ­¢æ—¥æœŸ
    - =C-c C-c= :: æ‰§è¡Œä»£ç å— / æ›´æ–°å¤é€‰æ¡†
    - =C-c C-e= :: å¯¼å‡º (Export dispatcher)
    - =C-c C-l= :: æ’å…¥/ç¼–è¾‘é“¾æ¥
    - =C-c C-o= :: æ‰“å¼€é“¾æ¥
    - =TAB= :: æŠ˜å /å±•å¼€æ ‡é¢˜
    - =S-TAB= :: å…¨å±€æŠ˜å /å±•å¼€

*** é…ç½®ç®¡ç†ï¼ˆæ–°å¢ï¼‰
    - =M-x mcg-org-show-status= :: æ˜¾ç¤ºé…ç½®çŠ¶æ€
    - =M-x mcg-org-list-modules= :: åˆ—å‡ºæ‰€æœ‰æ¨¡å—
    - =M-x mcg-org-load-module= :: åŠ è½½æŒ‡å®šæ¨¡å—
    - =M-x mcg-org-reload-module= :: é‡æ–°åŠ è½½æ¨¡å—

** å¤šå…‰æ ‡ / Markmacro (C-c m å‰ç¼€)

*** çŸ©å½¢æ“ä½œ
    - =C-c m s= :: è®¾ç½®çŸ©å½¢
    - =C-c m d= :: åˆ é™¤çŸ©å½¢
    - =C-c m r= :: æ›¿æ¢çŸ©å½¢
    - =C-c m i= :: æ’å…¥çŸ©å½¢

*** Mark è½¬æ¢
    - =C-c m c= :: Mark åˆ—
    - =C-c m S= :: Mark ç¬¦å·

*** åº”ç”¨å®
    - =C-c m a= :: åº”ç”¨åˆ°æ‰€æœ‰
    - =C-c m e= :: åº”ç”¨åˆ°é™¤ç¬¬ä¸€ä¸ªå¤–çš„æ‰€æœ‰

** ç¼–è¾‘å¢å¼º

*** è¡Œæ“ä½œ
    - =C-a= :: æ™ºèƒ½è¡Œé¦– (è·³è¿‡ç¼©è¿›)
    - =C-c <up>= :: åœ¨ä¸Šæ–¹æ’å…¥æ–°è¡Œ
    - =C-c <down>= :: åœ¨ä¸‹æ–¹æ’å…¥æ–°è¡Œ
    - =M-<up>= :: å‘ä¸Šç§»åŠ¨è¡Œ
    - =M-<down>= :: å‘ä¸‹ç§»åŠ¨è¡Œ

*** æ»šåŠ¨
    - =M-n= :: å‘ä¸‹æ»šåŠ¨ 1/3 çª—å£
    - =M-p= :: å‘ä¸Šæ»šåŠ¨ 1/3 çª—å£

*** æ’¤é”€/é‡åš
    - =C-/= :: æ’¤é”€
    - =C-?= :: é‡åš
    - =C-c u= :: Vundo (å¯è§†åŒ–æ’¤é”€æ ‘)

*** æ›¿æ¢
    - =C-c R= :: æ›¿æ¢å­—ç¬¦ä¸²
    - =C-c M-r= :: æ›¿æ¢æ­£åˆ™è¡¨è¾¾å¼
    - =M-%=  :: äº¤äº’å¼æ›¿æ¢ (query-replaceï¼ŒEmacs æ ‡å‡†)

** Yasnippet ä»£ç ç‰‡æ®µ

   - =C-c y n= :: æ–°å»ºä»£ç ç‰‡æ®µ
   - =C-c y v= :: è®¿é—®ä»£ç ç‰‡æ®µæ–‡ä»¶
   - =C-c y r= :: é‡æ–°åŠ è½½æ‰€æœ‰ç‰‡æ®µ

** Elisp å¼€å‘

*** Emacs Lisp Mode
    - =C-c C-b= :: æ‰§è¡Œ Buffer (eval-buffer)
    - =C-c C-c= :: æ‰§è¡Œå¹¶æ³¨é‡Šç»“æœ (eval-to-comment)
    - =C-c C-r= :: æ‰§è¡Œé€‰åŒº (eval-region)

** æ–‡ä»¶å’Œ Buffer

   - =C-c E= :: æ‰“å¼€é…ç½®æ–‡ä»¶
   - =C-c D= :: åˆ›å»ºç›®å½•
   - =C-c f r= :: æ‰“å¼€æœ€è¿‘æ–‡ä»¶

** å¸®åŠ©ç³»ç»Ÿ (Helpful å¢å¼º)

   - =C-h f= :: æŸ¥çœ‹å‡½æ•° (helpful-callable)
   - =C-h v= :: æŸ¥çœ‹å˜é‡ (helpful-variable)
   - =C-h k= :: æŸ¥çœ‹æŒ‰é”® (helpful-key)
   - =C-h x= :: æŸ¥çœ‹å‘½ä»¤ (helpful-command)
   - =C-c C-d= :: æŸ¥çœ‹å½“å‰ç‚¹çš„æ–‡æ¡£

** Transient èœå•

æŸäº›å¤æ‚åŠŸèƒ½æä¾›äº† transient èœå•ï¼ŒæŒ‰ä¸‹å‰ç¼€é”®ååŠ  =?= å¯æŸ¥çœ‹èœå•ï¼š

   - =C-c g ?= :: Git èœå•
   - =C-c s ?= :: æœç´¢èœå•

** æ ‡å‡† Emacs ç»‘å®šï¼ˆä¿ç•™ï¼‰

æœ¬é…ç½®ä¿ç•™äº†æ‰€æœ‰æ ‡å‡† Emacs å¿«æ·é”®ï¼š

   - =C-x C-f= :: æ‰“å¼€æ–‡ä»¶
   - =C-x C-s= :: ä¿å­˜æ–‡ä»¶
   - =C-x b= :: åˆ‡æ¢ Buffer
   - =C-x k= :: å…³é—­ Buffer
   - =M-x= :: æ‰§è¡Œå‘½ä»¤
   - =C-g= :: å–æ¶ˆæ“ä½œ
   - =M-g g= :: è·³è½¬åˆ°è¡Œ (avy-goto-line)
   - =M-g M-g= :: è·³è½¬åˆ°è¡Œå· (goto-line, Emacs é»˜è®¤)

** Which-key é›†æˆ â­

æ‰€æœ‰å‰ç¼€é”®éƒ½æä¾›äº† which-key æè¿°ã€‚æŒ‰ä¸‹ä»»æ„å‰ç¼€é”®ï¼ˆå¦‚ =C-c g=ï¼‰å¹¶ç­‰å¾… 0.3 ç§’ï¼Œwhich-key ä¼šè‡ªåŠ¨æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨çš„è¡¥å…¨é€‰é¡¹ã€‚

*** ç¾åŒ–ç‰¹æ€§
    - å›¾æ ‡å‰ç¼€æè¿° (ğŸ“ Files, ğŸ” Search, ğŸªŸ Window ç­‰)
    - ç¬¦å·æ›¿æ¢ (â†â†‘â†’â†“, â, â‡¥, â£ ç­‰)
    - è‡ªå®šä¹‰é¢œè‰²æ–¹æ¡ˆ (Tokyo Night é£æ ¼)
    - åˆ†ç»„æ˜¾ç¤ºï¼Œæ¸…æ™°æ˜“è¯»

*** ä¸»è¦å‰ç¼€
    - =C-c= :: âš™ User (ç”¨æˆ·è‡ªå®šä¹‰)
    - =C-c g= ::  Git
    - =C-c w= :: ğŸªŸ Window
    - =C-c s= :: ğŸ” Search
    - =C-c r= :: ğŸ”§ Refactor
    - =C-c t= :: ğŸ“‘ Tabs
    - =C-c n= :: ğŸ“ Notes/Org
    - =M-g= :: â¡ Goto (Avy è·³è½¬)

åœ¨ which-key æ˜¾ç¤ºæ—¶ï¼š
   - =C-h n= :: ä¸‹ä¸€é¡µ
   - =C-h p= :: ä¸Šä¸€é¡µ
   - =C-h u= :: æ’¤é”€/è¿”å›

* ğŸ”§ Customization

** Paths

   Edit =config-org/core/init-paths.org= to set custom paths:
   
   #+begin_src emacs-lisp
   (defvar mcg/project-dir "~/projects"
     "Projects directory")
   #+end_src

** Fonts

   Edit =config-org/core/init-font.org=:
   
   #+begin_src emacs-lisp
   (set-face-attribute 'default nil
                       :family "Consolas"
                       :height 120)
   #+end_src

** Languages

   Add language support in =config-org/lang/=:
   
   #+begin_src emacs-lisp
   (use-package lang-python
     :custom
     (python-shell-interpreter "python3"))
   #+end_src

** Themes

   Themes are in =site-lisp/extensions/themes/=
   
   #+begin_src emacs-lisp
   (load-theme 'doom-one t)
   #+end_src

* ğŸ“ Org Mode

** æ–°çš„æ¨¡å—åŒ–é…ç½®ç³»ç»Ÿ â­

   æœ¬é…ç½®é‡‡ç”¨å…¨æ–°çš„æ¨¡å—åŒ– Org mode é…ç½®ç³»ç»Ÿï¼ˆVersion 2.1ï¼‰ï¼š
   
   - *ç»Ÿä¸€å˜é‡ç®¡ç†* :: æ‰€æœ‰å˜é‡ä½¿ç”¨ =mcg-org-*= å‘½åç©ºé—´
   - *æ¨¡å—åŒ–åŠ è½½* :: æŒ‰éœ€åŠ è½½ï¼Œæ™ºèƒ½ä¾èµ–ç®¡ç†
   - *åŠŸèƒ½å¼€å…³* :: é€šè¿‡å˜é‡è½»æ¾å¯ç”¨/ç¦ç”¨åŠŸèƒ½
   - *é”™è¯¯è¯Šæ–­* :: å†…ç½®çŠ¶æ€æŸ¥çœ‹å’ŒéªŒè¯å·¥å…·

** é…ç½®ç»“æ„

   #+begin_src text
   config-org/org/
   â”œâ”€â”€ init-org-vars.org          # ğŸ”§ å˜é‡å®šä¹‰ï¼ˆå¿…éœ€ï¼‰
   â”œâ”€â”€ init-org-loader.org        # ğŸš€ é…ç½®åŠ è½½å™¨
   â”œâ”€â”€ init-org.org               # ğŸ“ æ ¸å¿ƒé…ç½®
   â”œâ”€â”€ init-org-agenda.org        # ğŸ“… Agenda é…ç½®
   â”œâ”€â”€ init-capture-hugo.org      # âœï¸ Capture & Hugo é›†æˆ
   â”œâ”€â”€ README-ORG-CONFIG.org      # ğŸ“– å®Œæ•´æ–‡æ¡£
   â””â”€â”€ HOWTO-USE-NEW-CONFIG.org   # ğŸ’¡ ä½¿ç”¨æŒ‡å—
   #+end_src

** Features

   æ ¸å¿ƒåŠŸèƒ½ï¼š
   
   - *Agenda* :: ä»»åŠ¡ç®¡ç†å’Œæ—¥ç¨‹å®‰æ’
   - *Capture* :: å¿«é€Ÿç¬”è®°æ•è·ï¼ˆå¤šç§æ¨¡æ¿ï¼‰
   - *Export* :: å¤šæ ¼å¼å¯¼å‡º (HTML, Markdown, PDF)
   - *Babel* :: æ–‡æ¡£å†…ä»£ç æ‰§è¡Œï¼ˆæ”¯æŒ Zigï¼ï¼‰âœ¨
   - *Hugo* :: åšå®¢å‘å¸ƒé›†æˆï¼ˆå¯é€‰ï¼‰
   - *ä¸­æ–‡æ—¥å†* :: å†œå†ã€èŠ‚æ°”ã€æ—¥å‡ºæ—¥è½

** Org Babel æ–‡å­¦ç¼–ç¨‹ âœ¨

   æœ¬é…ç½®æ”¯æŒ Org Babel æ–‡å­¦ç¼–ç¨‹ï¼Œå¯ä»¥åœ¨ Org æ–‡ä»¶ä¸­æ‰§è¡Œä»£ç å—ã€‚

*** æ”¯æŒçš„è¯­è¨€
    
    - âœ… *Emacs Lisp* - Emacs é…ç½®å’Œè„šæœ¬
    - âœ… *Python* - æ•°æ®åˆ†æã€è„šæœ¬
    - âœ… *Shell/Bash* - ç³»ç»Ÿå‘½ä»¤
    - âœ… *Zig* - ç³»ç»Ÿç¼–ç¨‹ï¼ˆè‡ªå®šä¹‰æ”¯æŒï¼ï¼‰ğŸ¦
    - âœ… *JavaScript* - å‰ç«¯è„šæœ¬
    - âœ… *C/C++* - ç³»ç»Ÿç¼–ç¨‹
    - âœ… *SQL* - æ•°æ®åº“æŸ¥è¯¢
    - âœ… *CSS* - æ ·å¼è¡¨
    - âœ… *PlantUML* - å›¾è¡¨ç»˜åˆ¶

*** å¿«æ·é”®
    
    #+begin_example
    C-c C-c         æ‰§è¡Œå½“å‰ä»£ç å—
    C-c C-v b       æ‰§è¡Œæ•´ä¸ª buffer
    C-c C-v t       Tangle æ–‡ä»¶ï¼ˆæå–ä»£ç ï¼‰
    C-c '           ç¼–è¾‘ä»£ç å—ï¼ˆä¸“ç”¨çª—å£ï¼‰
    C-c C-v C-r     ç§»é™¤æ‰€æœ‰ç»“æœ
    C-c C-v i       æ’å…¥æ–°ä»£ç å—
    #+end_example

*** ä½¿ç”¨ç¤ºä¾‹

    **** Zig ç¤ºä¾‹
    #+begin_example
    #+begin_src zig :results output
    const std = @import("std");
    
    pub fn main() !void {
        const stdout = std.io.getStdOut().writer();
        try stdout.print("Hello from Zig!\n", .{});
    }
    #+end_src
    #+end_example

    **** Python ç¤ºä¾‹
    #+begin_example
    #+begin_src python :results output
    for i in range(5):
        print(f"Count: {i}")
    #+end_src
    #+end_example

    **** Shell ç¤ºä¾‹
    #+begin_example
    #+begin_src shell :results output
    echo "Current directory:"
    pwd
    ls -la
    #+end_src
    #+end_example

*** å¸¸ç”¨å‚æ•°

    - =:results output= :: æ•è·æ ‡å‡†è¾“å‡º
    - =:results value= :: è¿”å›æœ€åä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼
    - =:exports both= :: å¯¼å‡ºä»£ç å’Œç»“æœ
    - =:session NAME= :: ä½¿ç”¨æŒä¹…åŒ–ä¼šè¯
    - =:file OUTPUT.png= :: å°†ç»“æœä¿å­˜åˆ°æ–‡ä»¶

*** é…ç½®ä½ç½®

    Babel é…ç½®æ–‡ä»¶ï¼š=config-org/org/init-org-babel.org=

** é…ç½®å˜é‡

   ä¸»è¦å¯è‡ªå®šä¹‰å˜é‡ï¼š
   
   #+begin_src emacs-lisp
   mcg-org-directory                # Org æ ¹ç›®å½•
   mcg-org-agenda-directory         # Agenda ç›®å½•
   mcg-blog-base-directory          # åšå®¢æ ¹ç›®å½•
   mcg-org-enable-hugo-integration  # Hugo é›†æˆå¼€å…³
   mcg-org-enable-chinese-calendar  # ä¸­æ–‡æ—¥å†å¼€å…³
   mcg-calendar-location-longitude  # åœ°ç†ä½ç½®ï¼ˆç»åº¦ï¼‰
   mcg-calendar-location-latitude   # åœ°ç†ä½ç½®ï¼ˆçº¬åº¦ï¼‰
   #+end_src

** ç®¡ç†å‘½ä»¤

   æ–°å¢çš„é…ç½®ç®¡ç†å‘½ä»¤ï¼š
   
   #+begin_src emacs-lisp
   M-x mcg-org-show-status      # æ˜¾ç¤ºé…ç½®çŠ¶æ€ï¼ˆæ¨èï¼‰
   M-x mcg-org-list-modules     # åˆ—å‡ºæ‰€æœ‰æ¨¡å—
   M-x mcg-org-load-module      # åŠ è½½æŒ‡å®šæ¨¡å—
   M-x mcg-org-reload-module    # é‡æ–°åŠ è½½æ¨¡å—
   M-x mcg-org-validate-config  # éªŒè¯é…ç½®
   #+end_src

** Capture Templates

   é…ç½®åœ¨ =config-org/org/init-capture-hugo.org=:
   
   - *ä»»åŠ¡* :: å·¥ä½œä»»åŠ¡ã€é˜…è¯»ä»»åŠ¡
   - *æ—¥è®°* :: æ¯æ—¥ TODOã€éšç¬”
   - *ç¬”è®°* :: å¿«é€Ÿç¬”è®°ã€çµæ„Ÿ
   - *æ—¥å¿—* :: å·¥ä½œæ—¥å¿—
   - *è´¦å•* :: è´¢åŠ¡è®°å½•
   - *å¯†ç * :: å¯†ç ç®¡ç†ï¼ˆåŠ å¯†ï¼‰
   - *åšå®¢* :: Hugo åšå®¢æ–‡ç« ï¼ˆå¤šåˆ†ç±»ï¼‰

** æ–‡æ¡£

   å®Œæ•´æ–‡æ¡£ä½äº =config-org/org/=:
   
   - =README-ORG-CONFIG.org= :: å®Œæ•´é…ç½®æ–‡æ¡£
   - =HOWTO-USE-NEW-CONFIG.org= :: å¿«é€Ÿä½¿ç”¨æŒ‡å— â­
   - =CHANGELOG-VAR-MIGRATION.org= :: å˜æ›´æ—¥å¿—

* ğŸ” Debugging

** Common Errors and Solutions â­

*** Extension Loading Errors

**** Error: Required extension not found
     #+begin_example
     Error: Required extension core/dash failed: Directory not found
     Suggestion: Run 'make init' to initialize submodules
     #+end_example

     *Solution:*
     #+begin_src bash
     # Initialize all submodules
     make init
     
     # Or manually
     git submodule update --init --recursive
     #+end_src

**** Error: Circular dependency detected
     #+begin_example
     Warning: Circular dependency detected: pkg-a -> pkg-b -> pkg-a
     #+end_example

     *Solution:*
     1. Run =M-x mcg-check-circular-dependencies= to identify the cycle
     2. Review the extension registry in =init-loadpath.el=
     3. Remove or restructure the circular dependency

**** Error: Extension dependency failed
     #+begin_example
     Warning: Failed to load dependency core/dash for completion/vertico
     #+end_example

     *Solution:*
     #+begin_src bash
     # Check if the dependency exists
     ls site-lisp/extensions/core/dash
     
     # If missing, reinitialize
     make init
     #+end_src

*** Git Submodule Errors

**** Error: Submodule not initialized
     #+begin_example
     fatal: no submodule mapping found in .gitmodules for path 'site-lisp/extensions/...'
     #+end_example

     *Solution:*
     #+begin_src bash
     git submodule update --init --recursive
     #+end_src

**** Error: Submodule has conflicts
     #+begin_example
     error: Your local changes to the following files would be overwritten by checkout
     #+end_example

     *Solution:*
     #+begin_src bash
     # Option 1: Stash changes
     cd site-lisp/extensions/[package]
     git stash
     cd ../../..
     make up
     
     # Option 2: Force update (loses local changes)
     git submodule update --force [path]
     #+end_src

**** Error: Detached HEAD in submodule
     #+begin_example
     HEAD detached at abc1234
     #+end_example

     *Note:* This is normal for submodules. If you need to make changes:
     #+begin_src bash
     cd site-lisp/extensions/[package]
     git checkout main  # or master
     #+end_src

*** Version Lock Errors

**** Error: Lock file not found
     #+begin_example
     Warning: packages-lock.el not found
     #+end_example

     *Solution:*
     #+begin_src bash
     # Create a new lock file
     make lock-packages
     #+end_src

**** Error: Cannot restore to locked version
     #+begin_example
     error: pathspec 'abc1234' did not match any file(s) known to git
     #+end_example

     *Solution:*
     #+begin_src bash
     # Fetch latest from remote first
     cd site-lisp/extensions/[package]
     git fetch --all
     cd ../../..
     make restore-packages
     #+end_src

*** Configuration Validation Errors

**** Error: Invalid Elisp syntax
     #+begin_example
     Syntax error in generated file: site-lisp/config/core/init-loadpath.el
     #+end_example

     *Solution:*
     1. Check the source Org file for syntax errors
     2. Regenerate the configuration:
        #+begin_src bash
        make clean
        make generate
        #+end_src

**** Error: Missing required feature
     #+begin_example
     Cannot open load file: No such file or directory, some-feature
     #+end_example

     *Solution:*
     1. Check if the extension providing the feature is registered
     2. Verify the extension directory exists
     3. Run =M-x mcg-validate-extensions=

*** Platform-Specific Errors

**** Windows: PowerShell execution policy
     #+begin_example
     File cannot be loaded because running scripts is disabled on this system
     #+end_example

     *Solution:*
     #+begin_src powershell
     # Run as Administrator
     Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
     #+end_src

**** Windows: Path too long
     #+begin_example
     Filename too long
     #+end_example

     *Solution:*
     #+begin_src powershell
     # Enable long paths (requires Windows 10 1607+)
     git config --system core.longpaths true
     #+end_src

**** Unix: Permission denied
     #+begin_example
     Permission denied: scripts/some-script.sh
     #+end_example

     *Solution:*
     #+begin_src bash
     chmod +x scripts/*.sh
     #+end_src

*** Diagnostic Commands

    Use these commands to diagnose issues:

    #+begin_src emacs-lisp
    ;; Validate all configuration
    M-x mcg-validate-all
    
    ;; Check extension status
    M-x mcg-display-categories-status
    
    ;; View platform info
    M-x mcg-display-platform-info
    
    ;; Check external tools
    M-x mcg-detect-external-tools
    
    ;; View degradation warnings
    M-x mcg-display-degradation-warnings
    
    ;; Check load status
    M-x mcg-load-status
    #+end_src

** Enable Debug Mode
   #+begin_src emacs-lisp
   (setq debug-on-error t)
   (setq debug-on-quit t)
   #+end_src

** View Startup Log
   #+begin_src bash
   emacs --debug-init 2>&1 | tee debug.log
   #+end_src

** Check Loaded Modules
   #+begin_src emacs-lisp
   M-x mcg-list-loaded-modules
   #+end_src

** Profiling
   #+begin_src emacs-lisp
   (require 'profiler)
   (profiler-start 'cpu+mem)
   ;; ... do work ...
   (profiler-report)
   (profiler-stop)
   #+end_src

* ğŸš€ Performance

   Configuration is optimized for fast startup:
   
   - *Lazy Loading* :: Language and Org support load on idle
   - *Fast GC* :: Increased GC threshold during startup
   - *Deferred* :: Heavy features load after 1-2 seconds
   
   Expected startup time: *< 1 second* on modern hardware.
   
   Startup time is displayed after loading:
   
   #+begin_example
   Emacs configuration loaded in 0.85 seconds
   #+end_example

* ğŸ“š Resources

** Learning Emacs
   - Press =C-h t= for the Emacs tutorial
   - Press =C-h i m org RET= for Org Mode manual
   - Visit [[https://www.emacswiki.org/][EmacsWiki]]

** Documentation
   - [[https://www.gnu.org/software/emacs/manual/][Emacs Manual]]
   - [[https://orgmode.org/manual/][Org Mode Manual]]
   - [[https://github.com/minad/vertico][Vertico]]
   - [[https://github.com/minad/marginalia][Marginalia]]
   - [[https://github.com/oantolin/embark][Embark]]
   - [[https://github.com/manateelazycat/lsp-bridge][lsp-bridge]]
   - [[https://magit.vc/][Magit]]

** Tips
   - Use =C-h v= to view variables
   - Use =C-h k= to see what a key does
   - Use Helpful (=C-c h=) for better documentation
   - Check =*Messages*= buffer for errors

* ğŸ¤ Contributing

   This is a personal configuration. Feel free to:
   
   1. Fork it for your own use
   2. Adapt it to your workflow
   3. Report issues or suggestions

* ğŸ™ Acknowledgments

   - All Emacs package maintainers
   - Org Mode community
   - Emacs Reddit/Discord communities
   - Language server protocol authors

* ğŸ“„ License

   Same as the parent dotfiles repository.
