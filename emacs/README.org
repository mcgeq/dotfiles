#+title: Emacs Configuration
#+author: mcge
#+email: mcgeq@outlook.com
#+date: 2025-02-16
#+language: en

* Welcome to My Emacs Configuration

This is a modern, modular Emacs configuration written using literate programming
with Org Mode. It's designed for Emacs 29+ with extensive language support,
LSP integration, and productivity features.

* Philosophy

** Built-in First
   Reconfigure Emacs to use as many built-in features as possible and use fewer
   unnecessary plugins.

** Modular Design
   Configuration split into logical modules organized by functionality

** Literate Programming
   Written in Org Mode for easy documentation and maintenance

** Performance Optimized
   Lazy loading, fast startup, and minimal overhead

* ğŸ¯ Features

** Core Stack
   - Emacs 29+ with tree-sitter support
   - LSP Bridge for language server integration
   - Vertico + Marginalia + Embark for completions
   - Magit for Git operations

** Language Support
   Full development support for:
   - *Systems*: C/C++, Rust (rust-analyzer), Lua
   - *Web*: TypeScript, JavaScript, HTML/CSS, JSX/React
   - *Dynamic*: Python, Bash
   - *Markup*: Markdown, Org Mode

** Key Features
   - [[https://github.com/minad/vertico][Vertico]]: Modern minibuffer completions
   - [[https://github.com/minad/marginalia][Marginalia]]: Rich annotations
   - [[https://github.com/oantolin/embark][Embark]]: Contextual actions
   - [[https://github.com/manateelazycat/lsp-bridge][LSP Bridge]]: Blazing fast LSP
   - [[https://magit.vc/][Magit]]: Git interface
   - [[https://github.com/manateelazycat/blink-search][Blink-search]]: Universal search
   - [[https://github.com/manateelazycat/color-rg][Color-rg]]: Fast grep
   - [[https://github.com/doomemacs/doom-modeline][Doom Modeline]]: Status line
   - [[https://github.com/manateelazycat/emacs-rime][Rime]]: Chinese input
   - *Org Mode V2.1*: æ–°æ¨¡å—åŒ–é…ç½®ç³»ç»Ÿï¼ˆç»Ÿä¸€å˜é‡ã€æ™ºèƒ½åŠ è½½ï¼‰â­

* ğŸ“¦ Installation

** Prerequisites
   - Emacs 29+ (recommended) or Emacs 28+ with tree-sitter
   - Git for package management
   - Node.js for lsp-bridge
   - (Optional) Universal Ctags for symbol navigation

** Quick Install

*** Step 1: Clone Repository
    #+begin_src bash
    git clone <repository-url> ~/dotfiles
    cd ~/dotfiles/emacs
    #+end_src

*** Step 2: Initialize Git Submodules
    #+begin_src bash
    # Using make (recommended)
    make init
    
    # Or directly
    git submodule update --init --recursive
    #+end_src

*** Step 3: Create User Configuration
    #+begin_src bash
    # Copy template to custom.el
    cp custom-example.el custom.el
    
    # Edit your settings (optional)
    # emacs custom.el
    #+end_src

*** Step 4: Generate Configuration
    #+begin_src bash
    # Generate Emacs Lisp from Org files
    make generate
    #+end_src
    
    This compiles the Org Mode files in =config-org/= to Emacs Lisp files in
    =site-lisp/config/=.

*** Step 5: Link to Emacs

**** Option A: Symlink (Recommended)
     #+begin_src bash
     # Linux/macOS
     ln -s ~/dotfiles/emacs ~/.emacs.d
     
     # Windows (PowerShell as Administrator)
     New-Item -ItemType SymbolicLink -Path $env:USERPROFILE\.emacs.d -Target D:\config\dotfiles\emacs
     #+end_src

**** Option B: Manual Load
     Add to your =~/.emacs= or =~/.emacs.d/init.el=:
     #+begin_src emacs-lisp
     (load-file "~/dotfiles/emacs/site-lisp/config/init.el")
     #+end_src

*** Step 6: First Launch
    #+begin_src bash
    emacs
    #+end_src
    
    Emacs will automatically compile the configuration on first run.

** Troubleshooting

   If you encounter issues:
   
   #+begin_src bash
   # Check package status
   make st
   
   # Clean and regenerate
   make clean
   make generate
   
   # Check Emacs version
   emacs --version  # Should be 28+ (29+ recommended)
   
   # View all commands
   make h
   #+end_src

* ğŸ—‚ï¸ Configuration Structure

#+begin_src text
emacs/
â”œâ”€â”€ Makefile                     # Build system for Org â†’ EL compilation
â”œâ”€â”€ README.org                   # This file
â”œâ”€â”€ config-org/                  # Source: Org Mode literate config
â”‚   â”œâ”€â”€ init.org                 # Main entry point
â”‚   â”œâ”€â”€ core/                    # Core configuration
â”‚   â”‚   â”œâ”€â”€ init-paths.org       # Path management
â”‚   â”‚   â”œâ”€â”€ init-loadpath.org    # Load-path setup
â”‚   â”‚   â”œâ”€â”€ init-const.org       # Constants
â”‚   â”‚   â”œâ”€â”€ init-font.org        # Font configuration
â”‚   â”‚   â”œâ”€â”€ init-function.org    # Custom functions
â”‚   â”‚   â”œâ”€â”€ init-builtin.org     # Built-in features
â”‚   â”‚   â””â”€â”€ init-verify.org      # Configuration validation
â”‚   â”œâ”€â”€ ui/                      # User interface
â”‚   â”œâ”€â”€ editor/                  # Editor features
â”‚   â”œâ”€â”€ completion/              # Completions
â”‚   â”œâ”€â”€ tools/                   # Tools
â”‚   â”œâ”€â”€ lang/                    # Language support
â”‚   â”œâ”€â”€ org/                     # Org Mode (æ–°æ¨¡å—åŒ–ç³»ç»Ÿ V2.1)
â”‚   â”‚   â”œâ”€â”€ init-org-vars.org    # å˜é‡å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ init-org-loader.org  # é…ç½®åŠ è½½å™¨
â”‚   â”‚   â”œâ”€â”€ init-org.org         # æ ¸å¿ƒé…ç½®
â”‚   â”‚   â”œâ”€â”€ init-org-agenda.org  # Agenda
â”‚   â”‚   â””â”€â”€ init-capture-hugo.org # Capture & Hugo
â”‚   â”œâ”€â”€ docs/                    # Documentation
â”‚   â””â”€â”€ etc/                     # Miscellaneous
â”œâ”€â”€ site-lisp/                   # Generated: Compiled EL files
â”‚   â”œâ”€â”€ config/                  # Same structure as config-org/
â”‚   â””â”€â”€ extensions/              # Git submodules
â”‚       â”œâ”€â”€ lsp/                 # LSP bridge
â”‚       â”œâ”€â”€ magit/               # Git interface
â”‚       â”œâ”€â”€ vertico/             # Completions
â”‚       â”œâ”€â”€ org/                 # Org Mode
â”‚       â”œâ”€â”€ blink-search/        # Search
â”‚       â””â”€â”€ ...                  # Other extensions
â”œâ”€â”€ snippets/                    # Snippets
â””â”€â”€ langservers/                 # Language server configs
#+end_src

* âš™ï¸ Configuration Management

** Makefile Commands

*** Configuration
    #+begin_src bash
    make generate        # Generate config from Org files
    make clean           # Clean generated files
    make generate-elc    # Generate and byte-compile
    #+end_src

*** Package Management
    #+begin_src bash
    make init            # Initialize Git Submodules (first time)
    make st              # Check package status (with remote check)
    make up              # Update packages safely (with branch check)
    make lock-packages   # Lock current package versions
    make restore-packages # Restore to locked versions
    #+end_src

*** Quick Reference
    #+begin_src bash
    make h               # Show help (all commands)
    #+end_src

    Shortcuts: =init=, =st=, =up=, =h=

** User Configuration

*** Custom Settings
    All user-specific settings should go in =custom.el= (automatically loaded):

    #+begin_src emacs-lisp
    ;; Copy template
    ;; make init
    ;; cp custom-example.el custom.el
    
    ;; Then edit custom.el with your settings:
    
    ;; Module declarations (optional, declarative style)
    (mcg! 
     :core                    ; Core modules
     :ui doom-modeline        ; UI
     :completion vertico embark
     :lang lsp-bridge (rust lua typescript))
    
    ;; Custom settings
    (setq mcg-theme 'doom-one)
    (setq mcg-font-size 14)
    #+end_src

    Note: =custom.el= is gitignored (personal settings)

** Module System

   Configuration is organized into phases:
   
   1. *Phase 1*: Core Infrastructure
      - Path management
      - Load-path setup
      - Configuration validation
      - Constants and utilities
   
   2. *Phase 2*: UI and Themes
      - Doom modeline
      - Awesome tray
      - UI customization
   
   3. *Phase 3*: Editor Enhancement
      - Line numbers
      - Indentation
      - Tree-sitter
      - Auto-save
   
   4. *Phase 4*: Completions
      - Vertico
      - Marginalia
      - Embark
      - Yasnippet
   
   5. *Phase 5*: Keybindings
      - Global bindings
      - Mode-specific bindings
   
   6. *Phase 6*: LSP and Languages* (delayed)
      - lsp-bridge
      - Language-specific configs
   
   7. *Phase 7*: Org and Docs* (delayed)
      - Org Mode (æ–°æ¨¡å—åŒ–åŠ è½½å™¨)
      - init-org-loader (æ™ºèƒ½ä¾èµ–ç®¡ç†)
      - Markdown
      - Documentation tools

** Adding New Modules

   #+begin_example org
   1. Create an Org file in the appropriate config-org/ directory
   2. Use Org Babel with :tangle directive:
      * module-name.el
      :PROPERTIES:
      :HEADER-ARGS: :tangle path/to/module-name.el :lexical t
      :END:
      
      #+BEGIN_SRC emacs-lisp
      ;; Your code here
      #+END_SRC
   3. Add (require 'module-name) to the appropriate phase in init.org
   4. Run make generate
   #+end_example

* âŒ¨ï¸ Key Bindings

æœ¬é…ç½®é‡‡ç”¨æ¨¡å—åŒ–ã€ç¬¦åˆ Emacs æ ‡å‡†çš„å¿«æ·é”®è®¾è®¡ã€‚æ‰€æœ‰è‡ªå®šä¹‰ç»‘å®šéƒ½ä½¿ç”¨ =C-c= å‰ç¼€ï¼ˆç”¨æˆ·ä¿ç•™åŒºï¼‰ï¼Œå¹¶æä¾› which-key æè¿°ä»¥ä¾¿å‘ç°ã€‚

** å¿«æ·é”®æŸ¥è¯¢
   - =C-h K= :: æ˜¾ç¤ºå¿«æ·é”®é€ŸæŸ¥è¡¨ï¼ˆå®Œæ•´åˆ—è¡¨ï¼‰
   - =C-c w ?= :: Which-key ä½¿ç”¨æç¤º
   - =C-c w p= :: æ˜¾ç¤ºæ‰€æœ‰å®šä¹‰çš„å‰ç¼€
   - =C-c w m= :: æ˜¾ç¤ºå½“å‰ major mode çš„å¿«æ·é”®
   - =C-h b= :: Emacs æ ‡å‡†ï¼šæ˜¾ç¤ºæ‰€æœ‰ç»‘å®š

** LSP / ä»£ç å¯¼èˆª (æ ‡å‡†ç»‘å®š)

*** å¯¼èˆª
    - =M-.= :: è·³è½¬åˆ°å®šä¹‰ (lsp-bridge-find-def)
    - =M-,= :: è¿”å› (lsp-bridge-find-def-return)
    - =M-?= :: æŸ¥æ‰¾å¼•ç”¨ (lsp-bridge-find-references)
    - =C-M-.= :: åœ¨å¦ä¸€çª—å£æ‰“å¼€å®šä¹‰

*** æ–‡æ¡£
    - =C-h .= :: æ˜¾ç¤ºæ–‡æ¡£ (lsp-bridge-popup-documentation)
    - =C-h ,= :: æ˜¾ç¤ºå‡½æ•°ç­¾å (lsp-bridge-show-signature)
    - =C-h <up>= :: æ–‡æ¡£å‘ä¸Šæ»šåŠ¨
    - =C-h <down>= :: æ–‡æ¡£å‘ä¸‹æ»šåŠ¨

*** é‡æ„ (C-c r å‰ç¼€)
    - =C-c r r= :: é‡å‘½åç¬¦å· (lsp-bridge-rename)
    - =C-c r i= :: ä»£ç æ“ä½œ (lsp-bridge-code-action)
    - =C-c r f= :: æ ¼å¼åŒ–ä»£ç  (lsp-bridge-code-format)
    - =C-c r l= :: æŸ¥æ‰¾å®ç° (lsp-bridge-find-impl)
    - =C-c r w= :: å·¥ä½œåŒºç¬¦å·åˆ—è¡¨

*** è¯Šæ–­ (M-g å‰ç¼€ - Emacs æ ‡å‡†)
    - =M-g n= :: ä¸‹ä¸€ä¸ªé”™è¯¯ (lsp-bridge-diagnostic-jump-next)
    - =M-g p= :: ä¸Šä¸€ä¸ªé”™è¯¯ (lsp-bridge-diagnostic-jump-prev)
    - =M-g l= :: é”™è¯¯åˆ—è¡¨ (lsp-bridge-diagnostic-list)

** Git / Magit (C-c g å‰ç¼€)

*** ä¸»è¦å‘½ä»¤
    - =C-x g= :: Magit çŠ¶æ€ (æ ‡å‡†ç»‘å®š)
    - =C-x M-g= :: Magit dispatch
    - =C-c g s= :: Magit çŠ¶æ€ (magit-status)
    - =C-c g l= :: Git æ—¥å¿— (magit-log)
    - =C-c g d= :: Magit dispatch (magit-dispatch)
    - =C-c g f= :: æ–‡ä»¶æ“ä½œ (magit-file-dispatch)
    - =C-c g ?= :: Git èœå• (mcg-git-menu)

*** åˆ†æ”¯æ“ä½œ (C-c g b å­å‰ç¼€)
    - =C-c g b b= :: åˆ›å»ºåˆ†æ”¯
    - =C-c g b r= :: é‡å‘½ååˆ†æ”¯
    - =C-c g b d= :: åˆ é™¤åˆ†æ”¯

*** è¿œç¨‹æ“ä½œ (C-c g r å­å‰ç¼€)
    - =C-c g r a= :: æ·»åŠ è¿œç¨‹
    - =C-c g r r= :: é‡å‘½åè¿œç¨‹
    - =C-c g r d= :: åˆ é™¤è¿œç¨‹

*** æ¨é€/æ‹‰å–
    - =C-c g p= :: Push (magit-push)
    - =C-c g f= :: Pull (magit-pull)

*** å­æ¨¡å— (C-c g m å­å‰ç¼€)
    - =C-c g m a= :: æ·»åŠ å­æ¨¡å—
    - =C-c g m r= :: åˆ é™¤å­æ¨¡å—
    - =C-c g m u= :: æ›´æ–°å­æ¨¡å—

*** æ–‡ä»¶æ“ä½œ (C-c g F å­å‰ç¼€)
    - =C-c g F r= :: é‡å‘½åæ–‡ä»¶
    - =C-c g F d= :: åˆ é™¤æ–‡ä»¶

** æœç´¢ / Search (C-c s å‰ç¼€)

*** Buffer å†…æœç´¢
    - =C-c s l= :: æœç´¢è¡Œ (consult-line)
    - =C-c s i= :: Imenu å¯¼èˆª (consult-imenu)
    - =C-c s m= :: Mark å¯¼èˆª (consult-mark)

*** é¡¹ç›®æœç´¢ï¼ˆcolor-rg - æ— ä¸­æ–‡ç¼–ç é—®é¢˜ï¼‰
    - =C-c s g= :: æœç´¢å†…å®¹ (color-rg-search-input)
    - =C-c s G= :: é¡¹ç›®å†…æœç´¢å†…å®¹ (color-rg-search-input-in-project)
    - =C-c s s= :: æœç´¢ç¬¦å· (color-rg-search-symbol)
    - =C-c s S= :: é¡¹ç›®å†…æœç´¢ç¬¦å· (color-rg-search-symbol-in-project)
    - =C-c s .= :: å½“å‰æ–‡ä»¶æœç´¢ç¬¦å· (color-rg-search-symbol-in-current-file)
    - =C-c s ,= :: å½“å‰æ–‡ä»¶æœç´¢å†…å®¹ (color-rg-search-input-in-current-file)

*** Blink Searchï¼ˆå¿«é€Ÿæœç´¢ï¼‰
    - =C-c s B= :: å¤šåç«¯æœç´¢ï¼ˆä¸»å…¥å£ï¼‰
    - =C-c s D= :: å½“å‰ç›®å½•æ–‡ä»¶ï¼ˆç«‹å³æ˜¾ç¤ºï¼‰
    - =C-c s P= :: é¡¹ç›®æ–‡ä»¶ï¼ˆç«‹å³æ˜¾ç¤ºï¼‰

*** Buffer/æ–‡ä»¶åˆ‡æ¢
    - =C-c s b= :: åˆ‡æ¢ Buffer (consult-buffer)
    - =C-c s r= :: æœ€è¿‘æ–‡ä»¶ (consult-recent-file)
    - =C-c s o= :: Org æ ‡é¢˜å¯¼èˆª (mcg/consult-find-org-headings)

*** èœå•
    - =C-c s ?= :: æœç´¢èœå• (transient)

*** Embark (ä¸Šä¸‹æ–‡æ“ä½œ)
    - =C-.= :: Embark act (å¯¹å½“å‰é¡¹æ‰§è¡Œæ“ä½œ)
    - =C-,= :: Embark dwim (æ™ºèƒ½æ“ä½œ)

*** ğŸ’¡ æœç´¢ä½¿ç”¨æç¤º

**** å·¥å…·é€‰æ‹©ï¼ˆæ–¹æ¡ˆ Bï¼šæ··åˆé…ç½®ï¼‰
    - *Buffer å†…æœç´¢*ï¼šä½¿ç”¨ =consult-line/imenu= ï¼ˆæœ€ä½³ä½“éªŒï¼‰
    - *æ–‡ä»¶æŸ¥æ‰¾*ï¼šä½¿ç”¨ =blink-search= ï¼ˆç«‹å³æ˜¾ç¤ºï¼Œæ— ç¼–ç é—®é¢˜ï¼‰
    - *å†…å®¹/ç¬¦å·æœç´¢*ï¼šä½¿ç”¨ =color-rg= ï¼ˆä¸“ä¸šæœç´¢ï¼ŒUTF-8 å‹å¥½ï¼‰

**** Color-rg ä½¿ç”¨è¯´æ˜
    - äº¤äº’å¼æœç´¢ç•Œé¢ï¼Œæ”¯æŒå®æ—¶ç¼–è¾‘ç»“æœ
    - æ™ºèƒ½ç¬¦å·è¯†åˆ«ï¼Œè‡ªåŠ¨é«˜äº®åŒ¹é…
    - æ”¯æŒé¡¹ç›®èŒƒå›´å’Œæ–‡ä»¶èŒƒå›´æœç´¢
    - *å®Œç¾çš„ä¸­æ–‡æ”¯æŒ*ï¼Œæ— ç¼–ç é—®é¢˜

**** Blink Search ä½¿ç”¨è¯´æ˜
    - =C-c s B= æ‰“å¼€åï¼ŒæŒ‰ =TAB= åˆ‡æ¢ä¸åŒåç«¯
    - ç«‹å³æ˜¾ç¤ºæ–‡ä»¶åˆ—è¡¨ï¼Œæ— éœ€ç­‰å¾…è¾“å…¥
    - Python åç«¯ï¼ŒUTF-8 åŸç”Ÿæ”¯æŒ
    - éœ€è¦ Python 3 å’Œä¾èµ–ï¼š~pip3 install epc orjson rapidfuzz~

**** ä¾èµ–å·¥å…·
    - =color-rg= å’Œ =blink-search= éœ€è¦ =ripgrep= : ~scoop install ripgrep~
    - =blink-search= éœ€è¦ Python 3 ç¯å¢ƒ
    - *å·²ç§»é™¤*ï¼š=consult-find= ï¼ˆWindows ç¼–ç é—®é¢˜ï¼‰å’Œ =consult-ripgrep= ï¼ˆcolor-rg æ›´å¥½ï¼‰

** æ ‡ç­¾é¡µ / Tabs (C-c t å‰ç¼€)

*** å¯¼èˆª
    - =C-c t n= :: ä¸‹ä¸€ä¸ªæ ‡ç­¾é¡µ
    - =C-c t p= :: ä¸Šä¸€ä¸ªæ ‡ç­¾é¡µ
    - =C-c t f= :: ç¬¬ä¸€ä¸ªæ ‡ç­¾é¡µ
    - =C-c t l= :: æœ€åä¸€ä¸ªæ ‡ç­¾é¡µ

*** ç®¡ç†
    - =C-c t k= :: å…³é—­å½“å‰æ ‡ç­¾é¡µ
    - =C-c t o= :: å…³é—­å…¶ä»–æ ‡ç­¾é¡µ
    - =C-c t K= :: å…³é—­æ‰€æœ‰æ ‡ç­¾é¡µ

*** å¿«é€Ÿè®¿é—®
    - =C-c t 1/2/3= :: è·³è½¬åˆ°æ ‡ç­¾é¡µ 1/2/3

** Org Mode / ç¬”è®° (C-c n å‰ç¼€)

*** æ•è·å’Œè®®ç¨‹
    - =C-c n c= :: Org capture (å¿«é€Ÿæ•è·)
    - =C-c n a= :: Org agenda (è®®ç¨‹è§†å›¾)
    - =C-c n l= :: å­˜å‚¨é“¾æ¥ (org-store-link)
    - =C-c n t= :: Todo åˆ—è¡¨ (org-todo-list)

*** Org Buffer å†…ï¼ˆæ ‡å‡†å¿«æ·é”®ï¼‰
    - =C-c C-w= :: Org refile (é‡æ–°å½’æ¡£)
    - =C-c C-t= :: åˆ‡æ¢ TODO çŠ¶æ€
    - =C-c C-s= :: è®¾ç½®è®¡åˆ’æ—¶é—´
    - =C-c C-d= :: è®¾ç½®æˆªæ­¢æ—¥æœŸ
    - =C-c C-c= :: æ‰§è¡Œä»£ç å— / æ›´æ–°å¤é€‰æ¡†
    - =C-c C-e= :: å¯¼å‡º (Export dispatcher)
    - =C-c C-l= :: æ’å…¥/ç¼–è¾‘é“¾æ¥
    - =C-c C-o= :: æ‰“å¼€é“¾æ¥
    - =TAB= :: æŠ˜å /å±•å¼€æ ‡é¢˜
    - =S-TAB= :: å…¨å±€æŠ˜å /å±•å¼€

*** é…ç½®ç®¡ç†ï¼ˆæ–°å¢ï¼‰
    - =M-x mcg-org-show-status= :: æ˜¾ç¤ºé…ç½®çŠ¶æ€
    - =M-x mcg-org-list-modules= :: åˆ—å‡ºæ‰€æœ‰æ¨¡å—
    - =M-x mcg-org-load-module= :: åŠ è½½æŒ‡å®šæ¨¡å—
    - =M-x mcg-org-reload-module= :: é‡æ–°åŠ è½½æ¨¡å—

** å¤šå…‰æ ‡ / Markmacro (C-c m å‰ç¼€)

*** çŸ©å½¢æ“ä½œ
    - =C-c m s= :: è®¾ç½®çŸ©å½¢
    - =C-c m d= :: åˆ é™¤çŸ©å½¢
    - =C-c m r= :: æ›¿æ¢çŸ©å½¢
    - =C-c m i= :: æ’å…¥çŸ©å½¢

*** Mark è½¬æ¢
    - =C-c m c= :: Mark åˆ—
    - =C-c m S= :: Mark ç¬¦å·

*** åº”ç”¨å®
    - =C-c m a= :: åº”ç”¨åˆ°æ‰€æœ‰
    - =C-c m e= :: åº”ç”¨åˆ°é™¤ç¬¬ä¸€ä¸ªå¤–çš„æ‰€æœ‰

** ç¼–è¾‘å¢å¼º

*** è¡Œæ“ä½œ
    - =C-a= :: æ™ºèƒ½è¡Œé¦– (è·³è¿‡ç¼©è¿›)
    - =C-c <up>= :: åœ¨ä¸Šæ–¹æ’å…¥æ–°è¡Œ
    - =C-c <down>= :: åœ¨ä¸‹æ–¹æ’å…¥æ–°è¡Œ
    - =M-<up>= :: å‘ä¸Šç§»åŠ¨è¡Œ
    - =M-<down>= :: å‘ä¸‹ç§»åŠ¨è¡Œ

*** æ»šåŠ¨
    - =M-n= :: å‘ä¸‹æ»šåŠ¨ 1/3 çª—å£
    - =M-p= :: å‘ä¸Šæ»šåŠ¨ 1/3 çª—å£

*** æ’¤é”€/é‡åš
    - =C-/= :: æ’¤é”€
    - =C-?= :: é‡åš
    - =C-c u= :: Vundo (å¯è§†åŒ–æ’¤é”€æ ‘)

*** æ›¿æ¢
    - =C-c R= :: æ›¿æ¢å­—ç¬¦ä¸²
    - =C-c M-r= :: æ›¿æ¢æ­£åˆ™è¡¨è¾¾å¼
    - =M-%=  :: äº¤äº’å¼æ›¿æ¢ (query-replaceï¼ŒEmacs æ ‡å‡†)

** Yasnippet ä»£ç ç‰‡æ®µ

   - =C-c y n= :: æ–°å»ºä»£ç ç‰‡æ®µ
   - =C-c y v= :: è®¿é—®ä»£ç ç‰‡æ®µæ–‡ä»¶
   - =C-c y r= :: é‡æ–°åŠ è½½æ‰€æœ‰ç‰‡æ®µ

** Elisp å¼€å‘

*** Emacs Lisp Mode
    - =C-c C-b= :: æ‰§è¡Œ Buffer (eval-buffer)
    - =C-c C-c= :: æ‰§è¡Œå¹¶æ³¨é‡Šç»“æœ (eval-to-comment)
    - =C-c C-r= :: æ‰§è¡Œé€‰åŒº (eval-region)

** æ–‡ä»¶å’Œ Buffer

   - =C-c E= :: æ‰“å¼€é…ç½®æ–‡ä»¶
   - =C-c D= :: åˆ›å»ºç›®å½•
   - =C-c f r= :: æ‰“å¼€æœ€è¿‘æ–‡ä»¶

** å¸®åŠ©ç³»ç»Ÿ (Helpful å¢å¼º)

   - =C-h f= :: æŸ¥çœ‹å‡½æ•° (helpful-callable)
   - =C-h v= :: æŸ¥çœ‹å˜é‡ (helpful-variable)
   - =C-h k= :: æŸ¥çœ‹æŒ‰é”® (helpful-key)
   - =C-h x= :: æŸ¥çœ‹å‘½ä»¤ (helpful-command)
   - =C-c C-d= :: æŸ¥çœ‹å½“å‰ç‚¹çš„æ–‡æ¡£

** Transient èœå•

æŸäº›å¤æ‚åŠŸèƒ½æä¾›äº† transient èœå•ï¼ŒæŒ‰ä¸‹å‰ç¼€é”®ååŠ  =?= å¯æŸ¥çœ‹èœå•ï¼š

   - =C-c g ?= :: Git èœå•
   - =C-c s ?= :: æœç´¢èœå•

** æ ‡å‡† Emacs ç»‘å®šï¼ˆä¿ç•™ï¼‰

æœ¬é…ç½®ä¿ç•™äº†æ‰€æœ‰æ ‡å‡† Emacs å¿«æ·é”®ï¼š

   - =C-x C-f= :: æ‰“å¼€æ–‡ä»¶
   - =C-x C-s= :: ä¿å­˜æ–‡ä»¶
   - =C-x b= :: åˆ‡æ¢ Buffer
   - =C-x k= :: å…³é—­ Buffer
   - =M-x= :: æ‰§è¡Œå‘½ä»¤
   - =C-g= :: å–æ¶ˆæ“ä½œ
   - =M-g g= :: è·³è½¬åˆ°è¡Œ

** Which-key é›†æˆ

æ‰€æœ‰å‰ç¼€é”®éƒ½æä¾›äº† which-key æè¿°ã€‚æŒ‰ä¸‹ä»»æ„å‰ç¼€é”®ï¼ˆå¦‚ =C-c g=ï¼‰å¹¶ç­‰å¾… 0.5 ç§’ï¼Œwhich-key ä¼šè‡ªåŠ¨æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨çš„è¡¥å…¨é€‰é¡¹ã€‚

åœ¨ which-key æ˜¾ç¤ºæ—¶ï¼š
   - =C-h n= :: ä¸‹ä¸€é¡µ
   - =C-h p= :: ä¸Šä¸€é¡µ
   - =C-h u= :: æ’¤é”€/è¿”å›

* ğŸ”§ Customization

** Paths

   Edit =config-org/core/init-paths.org= to set custom paths:
   
   #+begin_src emacs-lisp
   (defvar mcg/project-dir "~/projects"
     "Projects directory")
   #+end_src

** Fonts

   Edit =config-org/core/init-font.org=:
   
   #+begin_src emacs-lisp
   (set-face-attribute 'default nil
                       :family "Consolas"
                       :height 120)
   #+end_src

** Languages

   Add language support in =config-org/lang/=:
   
   #+begin_src emacs-lisp
   (use-package lang-python
     :custom
     (python-shell-interpreter "python3"))
   #+end_src

** Themes

   Themes are in =site-lisp/extensions/themes/=
   
   #+begin_src emacs-lisp
   (load-theme 'doom-one t)
   #+end_src

* ğŸ“ Org Mode

** æ–°çš„æ¨¡å—åŒ–é…ç½®ç³»ç»Ÿ â­

   æœ¬é…ç½®é‡‡ç”¨å…¨æ–°çš„æ¨¡å—åŒ– Org mode é…ç½®ç³»ç»Ÿï¼ˆVersion 2.1ï¼‰ï¼š
   
   - *ç»Ÿä¸€å˜é‡ç®¡ç†* :: æ‰€æœ‰å˜é‡ä½¿ç”¨ =mcg-org-*= å‘½åç©ºé—´
   - *æ¨¡å—åŒ–åŠ è½½* :: æŒ‰éœ€åŠ è½½ï¼Œæ™ºèƒ½ä¾èµ–ç®¡ç†
   - *åŠŸèƒ½å¼€å…³* :: é€šè¿‡å˜é‡è½»æ¾å¯ç”¨/ç¦ç”¨åŠŸèƒ½
   - *é”™è¯¯è¯Šæ–­* :: å†…ç½®çŠ¶æ€æŸ¥çœ‹å’ŒéªŒè¯å·¥å…·

** é…ç½®ç»“æ„

   #+begin_src text
   config-org/org/
   â”œâ”€â”€ init-org-vars.org          # ğŸ”§ å˜é‡å®šä¹‰ï¼ˆå¿…éœ€ï¼‰
   â”œâ”€â”€ init-org-loader.org        # ğŸš€ é…ç½®åŠ è½½å™¨
   â”œâ”€â”€ init-org.org               # ğŸ“ æ ¸å¿ƒé…ç½®
   â”œâ”€â”€ init-org-agenda.org        # ğŸ“… Agenda é…ç½®
   â”œâ”€â”€ init-capture-hugo.org      # âœï¸ Capture & Hugo é›†æˆ
   â”œâ”€â”€ README-ORG-CONFIG.org      # ğŸ“– å®Œæ•´æ–‡æ¡£
   â””â”€â”€ HOWTO-USE-NEW-CONFIG.org   # ğŸ’¡ ä½¿ç”¨æŒ‡å—
   #+end_src

** Features

   æ ¸å¿ƒåŠŸèƒ½ï¼š
   
   - *Agenda* :: ä»»åŠ¡ç®¡ç†å’Œæ—¥ç¨‹å®‰æ’
   - *Capture* :: å¿«é€Ÿç¬”è®°æ•è·ï¼ˆå¤šç§æ¨¡æ¿ï¼‰
   - *Export* :: å¤šæ ¼å¼å¯¼å‡º (HTML, Markdown, PDF)
   - *Babel* :: æ–‡æ¡£å†…ä»£ç æ‰§è¡Œ
   - *Hugo* :: åšå®¢å‘å¸ƒé›†æˆï¼ˆå¯é€‰ï¼‰
   - *ä¸­æ–‡æ—¥å†* :: å†œå†ã€èŠ‚æ°”ã€æ—¥å‡ºæ—¥è½

** é…ç½®å˜é‡

   ä¸»è¦å¯è‡ªå®šä¹‰å˜é‡ï¼š
   
   #+begin_src emacs-lisp
   mcg-org-directory                # Org æ ¹ç›®å½•
   mcg-org-agenda-directory         # Agenda ç›®å½•
   mcg-blog-base-directory          # åšå®¢æ ¹ç›®å½•
   mcg-org-enable-hugo-integration  # Hugo é›†æˆå¼€å…³
   mcg-org-enable-chinese-calendar  # ä¸­æ–‡æ—¥å†å¼€å…³
   mcg-calendar-location-longitude  # åœ°ç†ä½ç½®ï¼ˆç»åº¦ï¼‰
   mcg-calendar-location-latitude   # åœ°ç†ä½ç½®ï¼ˆçº¬åº¦ï¼‰
   #+end_src

** ç®¡ç†å‘½ä»¤

   æ–°å¢çš„é…ç½®ç®¡ç†å‘½ä»¤ï¼š
   
   #+begin_src emacs-lisp
   M-x mcg-org-show-status      # æ˜¾ç¤ºé…ç½®çŠ¶æ€ï¼ˆæ¨èï¼‰
   M-x mcg-org-list-modules     # åˆ—å‡ºæ‰€æœ‰æ¨¡å—
   M-x mcg-org-load-module      # åŠ è½½æŒ‡å®šæ¨¡å—
   M-x mcg-org-reload-module    # é‡æ–°åŠ è½½æ¨¡å—
   M-x mcg-org-validate-config  # éªŒè¯é…ç½®
   #+end_src

** Capture Templates

   é…ç½®åœ¨ =config-org/org/init-capture-hugo.org=:
   
   - *ä»»åŠ¡* :: å·¥ä½œä»»åŠ¡ã€é˜…è¯»ä»»åŠ¡
   - *æ—¥è®°* :: æ¯æ—¥ TODOã€éšç¬”
   - *ç¬”è®°* :: å¿«é€Ÿç¬”è®°ã€çµæ„Ÿ
   - *æ—¥å¿—* :: å·¥ä½œæ—¥å¿—
   - *è´¦å•* :: è´¢åŠ¡è®°å½•
   - *å¯†ç * :: å¯†ç ç®¡ç†ï¼ˆåŠ å¯†ï¼‰
   - *åšå®¢* :: Hugo åšå®¢æ–‡ç« ï¼ˆå¤šåˆ†ç±»ï¼‰

** æ–‡æ¡£

   å®Œæ•´æ–‡æ¡£ä½äº =config-org/org/=:
   
   - =README-ORG-CONFIG.org= :: å®Œæ•´é…ç½®æ–‡æ¡£
   - =HOWTO-USE-NEW-CONFIG.org= :: å¿«é€Ÿä½¿ç”¨æŒ‡å— â­
   - =CHANGELOG-VAR-MIGRATION.org= :: å˜æ›´æ—¥å¿—

* ğŸ” Debugging

** Enable Debug Mode
   #+begin_src emacs-lisp
   (setq debug-on-error t)
   (setq debug-on-quit t)
   #+end_src

** View Startup Log
   #+begin_src bash
   emacs --debug-init 2>&1 | tee debug.log
   #+end_src

** Check Loaded Modules
   #+begin_src emacs-lisp
   M-x mcg-list-loaded-modules
   #+end_src

** Profiling
   #+begin_src emacs-lisp
   (require 'profiler)
   (profiler-start 'cpu+mem)
   ;; ... do work ...
   (profiler-report)
   (profiler-stop)
   #+end_src

* ğŸš€ Performance

   Configuration is optimized for fast startup:
   
   - *Lazy Loading* :: Language and Org support load on idle
   - *Fast GC* :: Increased GC threshold during startup
   - *Deferred* :: Heavy features load after 1-2 seconds
   
   Expected startup time: *< 1 second* on modern hardware.
   
   Startup time is displayed after loading:
   
   #+begin_example
   Emacs configuration loaded in 0.85 seconds
   #+end_example

* ğŸ“š Resources

** Learning Emacs
   - Press =C-h t= for the Emacs tutorial
   - Press =C-h i m org RET= for Org Mode manual
   - Visit [[https://www.emacswiki.org/][EmacsWiki]]

** Documentation
   - [[https://www.gnu.org/software/emacs/manual/][Emacs Manual]]
   - [[https://orgmode.org/manual/][Org Mode Manual]]
   - [[https://github.com/minad/vertico][Vertico]]
   - [[https://github.com/minad/marginalia][Marginalia]]
   - [[https://github.com/oantolin/embark][Embark]]
   - [[https://github.com/manateelazycat/lsp-bridge][lsp-bridge]]
   - [[https://magit.vc/][Magit]]

** Tips
   - Use =C-h v= to view variables
   - Use =C-h k= to see what a key does
   - Use Helpful (=C-c h=) for better documentation
   - Check =*Messages*= buffer for errors

* ğŸ¤ Contributing

   This is a personal configuration. Feel free to:
   
   1. Fork it for your own use
   2. Adapt it to your workflow
   3. Report issues or suggestions

* ğŸ™ Acknowledgments

   - All Emacs package maintainers
   - Org Mode community
   - Emacs Reddit/Discord communities
   - Language server protocol authors

* ğŸ“„ License

   Same as the parent dotfiles repository.
