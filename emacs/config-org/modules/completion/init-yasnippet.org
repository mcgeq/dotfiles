* init-yasnippet.el
:PROPERTIES:
:HEADER-ARGS: :tangle init-yasnippet.el :lexical t
:END:

** Headers
#+BEGIN_SRC emacs-lisp
;;; init-yasnippet.el --- Snippet System for MCG Emacs -*- lexical-binding: t; -*-

;; Filename: init-yasnippet.el
;; Description: Code snippet system module
;; Author: mcge <mcgeq@outlook.com>
;; Copyright (C) 2024-2026, mcge, all rights reserved.
;; Create   Date: 2026-01-07
;; Version: 3.0
;; Keywords: snippets, yasnippet
;; Compatibility: GNU Emacs 29.0+

;;; Commentary:
;;
;; Code snippet module for MCG Emacs configuration, responsible for:
;; - YASnippet configuration
;; - Custom snippet directories
;; - Git user info integration
;;

#+END_SRC

** Dependencies
#+BEGIN_SRC emacs-lisp
;;; Dependencies

(require 'core-lib)

#+END_SRC

** Variables
#+BEGIN_SRC emacs-lisp
;;; Variables

(defvar mcg-snippet-dirs nil
  "Custom code snippet directory list.")

#+END_SRC

** Git User Functions
#+BEGIN_SRC emacs-lisp
;;; Git User Functions

(defun mcg/get-git-user-name ()
  "Get Git configured username."
  (interactive)
  (replace-regexp-in-string
   "\n$" ""
   (shell-command-to-string "git config --get user.name")))

(defun mcg/get-git-user-email ()
  "Get Git configured email."
  (interactive)
  (replace-regexp-in-string
   "\n$" ""
   (shell-command-to-string "git config --get user.email")))

#+END_SRC

** YASnippet Configuration
#+BEGIN_SRC emacs-lisp
;;; YASnippet Configuration

(defun mcg--setup-yasnippet ()
  "Set up YASnippet code snippet system."
  (when (mcg-require-extension "completion/yasnippet" 'yasnippet)
    ;; Set custom snippet directories
    (let ((custom-dirs
           (list (expand-file-name "site-lisp/snippets" mcg-emacs-dir)
                 (expand-file-name "site-lisp/extensions/snippets/yasnippet-snippet/snippets"
                                   mcg-emacs-dir))))
      (dolist (dir custom-dirs)
        (when (file-directory-p dir)
          (add-to-list 'yas-snippet-dirs dir))))
    
    ;; Reload snippets
    (yas-reload-all)
    
    ;; Enable globally
    (yas-global-mode 1)
    
    ;; Disable in certain modes
    (dolist (hook '(term-mode-hook eshell-mode-hook))
      (add-hook hook (lambda () (yas-minor-mode -1))))
    
    (mcg-log "YASnippet configured")))

#+END_SRC

** Initialize
#+BEGIN_SRC emacs-lisp
;;; Initialize

(mcg--setup-yasnippet)

#+END_SRC

** Provide
#+BEGIN_SRC emacs-lisp
(provide 'init-yasnippet)
;;; init-yasnippet.el ends here
#+END_SRC
