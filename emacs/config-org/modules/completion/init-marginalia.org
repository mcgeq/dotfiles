#+TITLE: Marginalia Module
#+AUTHOR: mcge
#+PROPERTY: header-args:emacs-lisp :tangle init-marginalia.el :lexical t

* Marginalia Module

配置 marginalia 注解增强。

** File Header

#+begin_src emacs-lisp
;;; init-marginalia.el --- marginalia configuration -*- lexical-binding: t; -*-

;;; Commentary:
;; Configure marginalia from:
;; emacs/site-lisp/extensions/completion/marginalia

;;; Code:

(require 'core-lib)
#+end_src

** Setup

*** Setup Marginalia

#+begin_src emacs-lisp
;;; ============================================================
;;; Marginalia Configuration
;;; ============================================================

(defun mcg--setup-marginalia ()
  "Setup Marginalia candidate annotations."
  (when (mcg-require-extension "marginalia" t)
    ;; Alignment settings
    (setq marginalia-align 'right)
    (setq marginalia-align-offset 0)

    ;; Relative time display
    (setq marginalia-max-relative-age 3600)

    ;; Enable marginalia-mode
    (marginalia-mode 1)

    ;; Keybinding for cycling annotation levels
    (define-key minibuffer-local-map (kbd "M-A") #'marginalia-cycle)

    (mcg-log "Marginalia configured")))
#+end_src

*** Toggle Marginalia

#+begin_src emacs-lisp
(defun mcg/toggle-marginalia ()
  "Toggle Marginalia mode."
  (interactive)
  (if marginalia-mode
      (progn
        (marginalia-mode -1)
        (message "Marginalia disabled"))
    (marginalia-mode 1)
    (message "Marginalia enabled")))
#+end_src

** Initialize

#+begin_src emacs-lisp
(mcg--setup-marginalia)
#+end_src

** Provide

#+begin_src emacs-lisp
(provide 'init-marginalia)
;;; init-marginalia.el ends here
#+end_src
