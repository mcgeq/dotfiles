#+TITLE: Helpful Module
#+AUTHOR: mcge
#+PROPERTY: header-args:emacs-lisp :tangle init-helpful.el :lexical t

* Helpful Module

本模块负责 MCG Emacs 的增强帮助功能，包括：
- 提供更多上下文信息的帮助缓冲区
- 用 Helpful 替代默认的帮助命令

** File Header

#+begin_src emacs-lisp
;;; init-helpful.el --- Helpful Configuration for MCG Emacs -*- lexical-binding: t; -*-

;; Filename: init-helpful.el
;; Description: Helpful enhanced help module
;; Author: mcge <mcgeq@outlook.com>
;; Copyright (C) 2024-2026, mcge, all rights reserved.
;; Create   Date: 2026-01-10
;; Version: 3.0
;; Keywords: helpful, help, documentation
;; Compatibility: GNU Emacs 29.0+

;;; Commentary:
;;
;; Helpful module for MCG Emacs, responsible for:
;; - Providing enhanced help buffers with more context
;; - Replacing default help commands with helpful alternatives
;;
;; Module metadata:
;; :depends ()
;; :defer nil
;;
#+end_src

** Require

#+begin_src emacs-lisp
;;; Code:

(require 'core-lib)
#+end_src

** Helpful Configuration

Helpful 配置函数，提供更丰富的帮助信息，包括源代码、引用等。

#+begin_src emacs-lisp
;;; ============================================================
;;; Helpful Configuration
;;; ============================================================

(defun mcg--setup-helpful ()
  "Setup Helpful enhanced help.
Helpful provides more contextual information in help buffers,
including source code, references, and more."
  ;; Helpful depends on dash, s, and f - ensure they are in load-path first
  ;; Try multiple possible locations
  (dolist (lib '("dash" "s.el" "f.el"))
    (let ((lib-path (or (mcg-extension-path lib)
                        (let ((core-path (expand-file-name (concat "site-lisp/extensions/core/" lib) mcg-emacs-dir)))
                          (when (and (file-directory-p core-path)
                                     (directory-files core-path nil "\\.el$" t))
                            core-path)))))
      (when lib-path
        (add-to-list 'load-path lib-path)
        (mcg-log "Added %s to load-path: %s" lib lib-path))))
  
  (when (mcg-require-extension "helpful" t)
    ;; Replace default help commands with helpful alternatives
    (global-set-key (kbd "C-h f") #'helpful-callable)
    (global-set-key (kbd "C-h v") #'helpful-variable)
    (global-set-key (kbd "C-h k") #'helpful-key)
    (global-set-key (kbd "C-h x") #'helpful-command)
    (global-set-key (kbd "C-c C-d") #'helpful-at-point)
    
    ;; Additional helpful commands
    (global-set-key (kbd "C-h F") #'helpful-function)
    (global-set-key (kbd "C-h C") #'helpful-command)
    
    (mcg-log "Helpful configured")))
#+end_src

** Initialize

初始化 Helpful 功能。

#+begin_src emacs-lisp
;;; ============================================================
;;; Initialize
;;; ============================================================

(mcg--setup-helpful)
#+end_src

** Provide Feature

#+begin_src emacs-lisp
(provide 'init-helpful)
;;; init-helpful.el ends here
#+end_src
