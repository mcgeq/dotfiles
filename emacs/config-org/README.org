#+TITLE: Emacs Configuration - Declarative Modular Architecture
#+AUTHOR: mcge
#+DATE: 2026-01-07
#+OPTIONS: toc:3 num:t

* Overview

MCG Emacs configuration adopts a declarative module system, inspired by Doom Emacs design philosophy while maintaining the advantages of Org Babel literate programming.

** Core Features

- Declarative module configuration (mcg! macro)
- Lazy loading support
- Module dependency management
- Unified extension management
- Complete test coverage

* Directory Structure

#+begin_src text
config-org/
├── init.org                      # Entry file (only contains mcg! declaration)
├── core/                         # Core layer (must be loaded)
│   ├── core-bootstrap.org        # Path definitions, performance optimization
│   ├── core-lib.org              # Utility functions, extension management
│   └── core-modules.org          # mcg! macro, module system
├── modules/                      # Feature modules
│   ├── ui/                       # UI related
│   │   ├── init-theme.org
│   │   ├── init-modeline.org
│   │   └── init-font.org
│   ├── editor/                   # Editor features
│   │   ├── init-defaults.org
│   │   ├── init-treesit.org
│   │   ├── init-navigation.org
│   │   └── init-keybindings.org
│   ├── completion/               # Completion system
│   │   ├── init-vertico.org
│   │   └── init-yasnippet.org
│   ├── tools/                    # Tools
│   │   ├── init-magit.org
│   │   ├── init-search.org
│   │   ├── init-rime.org
│   │   ├── init-utils.org
│   │   └── init-sort-tab.org
│   ├── input/                    # Input enhancement
│   │   ├── init-fingertip.org
│   │   └── init-wraplish.org
│   ├── org/                      # Org-mode
│   │   ├── init-org.org
│   │   ├── init-org-agenda.org
│   │   ├── init-org-babel.org
│   │   ├── init-org-capture.org
│   │   └── init-org-extras.org
│   ├── docs/                     # Documentation
│   │   └── init-markdown.org
│   └── lang/                     # Programming languages
│       ├── init-lsp.org
│       ├── init-lsp-common.org
│       ├── init-rust.org
│       ├── init-python.org
│       └── ...
└── private/                      # Private configuration (not committed to Git)
    └── config.org
#+end_src

* Quick Start

** 1. Initialize submodules

#+begin_src bash
make init
#+end_src

** 2. Compile configuration

#+begin_src bash
make
#+end_src

** 3. Start Emacs

#+begin_src bash
emacs -Q -l site-lisp/config/init.el
#+end_src

* Module Declaration

Use =mcg!= macro in =init.org= to declare enabled modules:

#+begin_src emacs-lisp
(mcg! :ui
      theme           ; Theme configuration
      modeline        ; Status bar
      font            ; Font configuration

      :editor
      defaults        ; Editor default configuration
      treesit         ; Tree-sitter support
      navigation      ; Navigation (avy, ace-window)
      keybindings     ; Keybindings

      :completion
      vertico         ; Vertical completion framework
      yasnippet       ; Code snippets

      :tools
      magit           ; Git client
      search          ; Search tools
      rime            ; Chinese input method
      utils           ; Utilities

      :lang
      lsp             ; LSP configuration
      rust            ; Rust development
      -lua            ; Disable Lua (with - prefix)
      )
#+end_src

* Private Configuration

Create private configuration file:

#+begin_src bash
cp config-org/private/config.org.example config-org/private/config.org
#+end_src

Private configuration will not be committed to Git.

* Makefile Commands

#+begin_src bash
# Compile configuration
make

# Clean generated files
make clean

# View file list
make list

# Run tests
make test

# Initialize submodules
make init

# Update submodules
make up

# View submodule status
make st
#+end_src

* Common Commands

| Command                  | Description                    |
|--------------------------+--------------------------------|
| M-x mcg-list-modules     | Show all modules and status    |
| M-x mcg/reload-module    | Reload specified module        |
| M-x mcg/show-keybindings | Show keybindings reference     |

* Changelog

** 2026-01-07 - Release

- Declarative module system (mcg! macro)
- Lazy loading support
- Complete test coverage
- Unified extension management
